<!DOCTYPE html>

<html class="article-header-style-default">
<head>
	
	<title>使用 OpenCore 引导黑苹果 - Xjn&#39;s Blog</title>
	<meta charset="utf-8">
	
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	
	<meta name="description" content="简介OpenCore(OC) 是一种新的引导方式，越来越多的 kexts 开始放弃 Clover, 我相信提早使用 OC 会对你未来使用黑苹果会有很大的帮助。这是一个自然的现象，就像变色龙被 Clover 淘汰，而现在 OC 代替 Clover 也是大势所趋。你应该需要看一些相关的文章，来帮助你理解我的正文内容，同时也需要下载我推荐的软件。  阅读 Opencore Vanilla Desktop">
<meta property="og:type" content="article">
<meta property="og:title" content="使用 OpenCore 引导黑苹果">
<meta property="og:url" content="https://blog.xjn819.com/post/opencore-guide.html">
<meta property="og:site_name" content="Xjn&#39;s Blog">
<meta property="og:description" content="简介OpenCore(OC) 是一种新的引导方式，越来越多的 kexts 开始放弃 Clover, 我相信提早使用 OC 会对你未来使用黑苹果会有很大的帮助。这是一个自然的现象，就像变色龙被 Clover 淘汰，而现在 OC 代替 Clover 也是大势所趋。你应该需要看一些相关的文章，来帮助你理解我的正文内容，同时也需要下载我推荐的软件。  阅读 Opencore Vanilla Desktop">
<meta property="og:locale">
<meta property="og:image" content="https://i.loli.net/2020/10/31/qonmCcpUJyrk84g.png">
<meta property="og:image" content="https://i.loli.net/2020/10/31/vhNd2tGwArqlZuk.png">
<meta property="og:image" content="https://i.loli.net/2020/10/31/k5jDCx9c3WdJunh.png">
<meta property="og:image" content="https://i.loli.net/2020/10/31/EfxazsJNZLKmgv3.png">
<meta property="og:image" content="https://i.loli.net/2020/10/31/SzvArXcH4OimtR9.png">
<meta property="og:image" content="https://i.loli.net/2020/11/01/fO69YhztbwBrMsd.png">
<meta property="og:image" content="https://i.loli.net/2020/11/01/gCaplW4bBY39KJs.png">
<meta property="og:image" content="https://i.loli.net/2020/11/01/cRhHzeEiAQXLSds.png">
<meta property="og:image" content="https://i.loli.net/2020/11/01/6p4iKMAeIHPyfBC.png">
<meta property="article:published_time" content="2020-10-29T14:42:50.000Z">
<meta property="article:modified_time" content="2020-11-18T12:08:17.025Z">
<meta property="article:author" content="Seon">
<meta property="article:tag" content="OpenCore">
<meta property="article:tag" content="Hackintosh">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/10/31/qonmCcpUJyrk84g.png">

	<meta name="theme-color" content="#212121">
	<meta name="theme-color-rgb" content="33,33,33">
	<meta name="theme-color-origin" content="#212121">
	<meta name="argon-enable-custom-theme-color" content="false">
	<meta name="theme-card-radius" content="4">
	<meta name="theme-version" content="1.0.1">
	<link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon">
	<link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon">

	
<link rel="stylesheet" href="/assets/argon_css_merged.css">

	
<link rel="stylesheet" href="/style.css">

	
<link rel="stylesheet" href="//fonts.loli.net/css?family=Open+Sans:300,400,600,700|Noto+Serif+SC:300,600&display=swap.css">

	
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

	
<script src="/assets/argon_js_merged.js"></script>

	
<script src="/assets/js/argon.min.js"></script>

	
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

	
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


	<script>
		var argonConfig = {
			language: "zh_CN",
			
				zoomify: {
					duration: 200,
					easing: "cubic-bezier(0.4,0,0,1)",
					scale: 0.9
				},
			
			pangu: "true",
			
				lazyload: {
					threshold: 800,
					effect: "fadeIn"
				},
			
			disable_pjax: false,
			headroom: true
		}
	</script>
	<script>
		var darkmodeAutoSwitch = "false";
		function setDarkmode(enable){
			if (enable == true){
				$("html").addClass("darkmode");
			}else{
				$("html").removeClass("darkmode");
			}
			$(window).trigger("scroll");
		}
		function toggleDarkmode(){
			if ($("html").hasClass("darkmode")){
				setDarkmode(false);
				sessionStorage.setItem("Argon_Enable_Dark_Mode", "false");
			}else{
				setDarkmode(true);
				sessionStorage.setItem("Argon_Enable_Dark_Mode", "true");
			}
		}
		if (sessionStorage.getItem("Argon_Enable_Dark_Mode") == "true"){
			setDarkmode(true);
		}
		function toggleDarkmodeByPrefersColorScheme(media){
			if (sessionStorage.getItem('Argon_Enable_Dark_Mode') == "false" || sessionStorage.getItem('Argon_Enable_Dark_Mode') == "true"){
				return;
			}
			if (media.matches){
				setDarkmode(true);
			}else{
				setDarkmode(false);
			}
		}
		function toggleDarkmodeByTime(){
			if (sessionStorage.getItem('Argon_Enable_Dark_Mode') == "false" || sessionStorage.getItem('Argon_Enable_Dark_Mode') == "true"){
				return;
			}
			let hour = new Date().getHours();
			if (hour < 7 || hour >= 22){
				setDarkmode(true);
			}else{
				setDarkmode(false);
			}
		}
		if (darkmodeAutoSwitch == 'system'){
			var darkmodeMediaQuery = window.matchMedia("(prefers-color-scheme: dark)");
			darkmodeMediaQuery.addListener(toggleDarkmodeByPrefersColorScheme);
			toggleDarkmodeByPrefersColorScheme(darkmodeMediaQuery);
		}
		if (darkmodeAutoSwitch == 'time'){
			toggleDarkmodeByTime();
		}
		if (darkmodeAutoSwitch == 'alwayson'){
			setDarkmode(true);
		}

		function toggleAmoledDarkMode(){
			$("html").toggleClass("amoled-dark");
			if ($("html").hasClass("amoled-dark")){
				localStorage.setItem("Argon_Enable_Amoled_Dark_Mode", "true");
			}else{
				localStorage.setItem("Argon_Enable_Amoled_Dark_Mode", "false");
			}
		}
		if (localStorage.getItem("Argon_Enable_Amoled_Dark_Mode") == "true"){
			$("html").addClass("amoled-dark");
		}else if (localStorage.getItem("Argon_Enable_Amoled_Dark_Mode") == "false"){
			$("html").removeClass("amoled-dark");
		}
	</script>
	<script>
		if (navigator.userAgent.indexOf("Safari") !== -1 && navigator.userAgent.indexOf("Chrome") === -1){
			$("html").addClass("using-safari");
		}
	</script>

	
		
<script src="/assets/vendor/smoothscroll/smoothscroll1.js"></script>

	
<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/feed.xml" title="Xjn's Blog" type="application/atom+xml">
</head>



<style id="themecolor_css">
	
	:root{
		--themecolor: #212121;
		--themecolor-dark0: #1B1B1B;
		--themecolor-dark: #141414;
		--themecolor-dark2: #080808;
		--themecolor-dark3: #000000;
		--themecolor-light: #3B3B3B;
		--themecolor-rgbstr: 33,33,33;
		--themecolor-gradient: linear-gradient(150deg,var(--themecolor-light) 15%, var(--themecolor) 70%, var(--themecolor-dark0) 94%);

	}
</style>
<style id="theme_cardradius_css">
	:root{
		--card-radius: 4px;
	}
</style>

<body>
<div id="toolbar">
	<header class="header-global">
		<nav id="navbar-main" class="navbar navbar-main navbar-expand-lg navbar-transparent navbar-light bg-primary headroom--not-bottom headroom--not-top headroom--pinned">
			<div class="container">
				
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_global" aria-controls="navbar_global" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<a class="navbar-brand" href="/">Xjn&#39;s Blog</a>
				<div class="navbar-collapse collapse" id="navbar_global">
					<div class="navbar-collapse-header">
						<div class="row">
							<div class="col-6 collapse-brand"></div>
							<div class="col-6 collapse-close">
								<button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar_global" aria-controls="navbar_global" aria-expanded="false" aria-label="Toggle navigation">
									<span></span>
									<span></span>
								</button>
							</div>
						</div>
					</div>
					<ul id="navbar_search_btn_mobile" class="navbar-nav align-items-lg-center ml-lg-auto">
						<li class="nav-item" data-toggle="modal" data-target="#argon_search_modal" style="padding-left: 5px;">
							<a class="nav-link nav-link-icon">
								<i class="fa fa-search"></i>
								<span class="nav-link-inner--text d-lg-none">搜索</span>
							</a>
						</li>
					</ul>
					
							<ul class='navbar-nav navbar-nav-hover align-items-lg-center'>
								
										<li class='nav-item'>
											<a href='/' class='nav-link' >
												<i class='ni ni-book-bookmark d-lg-none'></i>
												<span class='nav-link-inner--text'>首页</span>
											</a>
											
										</li>
									
										<li class='nav-item'>
											<a href='/archives' class='nav-link' >
												<i class='ni ni-book-bookmark d-lg-none'></i>
												<span class='nav-link-inner--text'>归档</span>
											</a>
											
										</li>
									
										<li class='nav-item'>
											<a href='/feed.xml' class='nav-link' >
												<i class='ni ni-book-bookmark d-lg-none'></i>
												<span class='nav-link-inner--text'>订阅</span>
											</a>
											
										</li>
									
							</ul>
						
					<ul class="navbar-nav align-items-lg-center ml-lg-auto">
						<li class="nav-item" data-toggle="modal" data-target="#argon_search_modal" id="navbar_search_btn_pc">
							<a class="nav-link nav-link-icon">
								<i class="fa fa-search"></i>
								<span class="nav-link-inner--text d-lg-none">搜索</span>
							</a>
						</li>
					</ul>
				</div>
				
				<div id="navbar_menu_mask" data-toggle="collapse" data-target="#navbar_global"></div>
			</div>
		</nav>
	</header>
</div>
<div class="modal fade" id="argon_search_modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">搜索</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<!-- TODO -->
<div class="form-group mb-3">
	<div class="input-group input-group-alternative">
		<div class="input-group-prepend">
			<span class="input-group-text"><i class="fa fa-search"></i></span>
		</div>
		<input id="local-search-input" class="form-control" placeholder="搜索什么..." type="text"  autocomplete="off" data-search.path="search.xml" data-config.root="/">
	</div>
	<div id="local-search-result"></div>
</div>
			</div>
		</div>
	</div>
</div>
<!--Banner-->
<section id="banner" class="banner section section-lg section-shaped">
	<div class="shape  shape-primary">
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
	</div>

	
	<div id="banner_container" class="banner-container container text-center">
		
			<div class="banner-title text-white"><span class="banner-title-inner">Xjn´s Blog</span>
		
		</div>
	</div>
	
		<style>
			section.banner{
				background-image: url(/assets/img/banner.jpg) !important;
			}
		</style>
	
</section>


	<style>
		#content:before {
			content: '';
			display: block;
			position: fixed;
			left: 0;
			right: 0;
			top: 0;
			bottom: 0;
			z-index: -2;
			background: url(/assets/img/banner.jpg);
			background-position: center;
			background-size: cover;
			background-repeat: no-repeat;
			opacity: 1;
			transition: opacity .5s ease;
		}
		html.darkmode #content:before{
			filter: brightness(0.65);
		}
		
			#content:after {
				content: '';
				display: block;
				position: fixed;
				left: 0;
				right: 0;
				top: 0;
				bottom: 0;
				z-index: -2;
				background: url(/assets/img/banner.jpg);
				background-position: center;
				background-size: cover;
				background-repeat: no-repeat;
				opacity: 0;
				transition: opacity .5s ease;
			}
			html.darkmode #content:after {
				opacity: 1;
			}
			html.darkmode #content:before {
				opacity: 0;
			}
		
		
			#banner, #banner .shape {
				background: transparent !important;
			}
		
	</style>




<div id="float_action_buttons" class="float-action-buttons fabtns-unloaded">
	<button id="fabtn_toggle_sides" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-hidden="true" tooltip-move-to-left="移至左侧" tooltip-move-to-right="移至右侧">
		<span class="btn-inner--icon fabtn-show-on-right"><i class="fa fa-caret-left"></i></span>
		<span class="btn-inner--icon fabtn-show-on-left"><i class="fa fa-caret-right"></i></span>
	</button>
	<button id="fabtn_back_to_top" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-label="Back To Top" tooltip="回到顶部">
		<span class="btn-inner--icon"><i class="fa fa-angle-up"></i></span>
	</button>
	<button id="fabtn_go_to_comment" class="btn btn-icon btn-neutral fabtn shadow-sm d-none" type="button" <-% theme.fab_show_gotocomment_button ? "" : "style='display: none;'"  aria-label="Comment" tooltip="评论">
		<span class="btn-inner--icon"><i class="fa fa-comment-o"></i></span>
	</button>
	<button id="fabtn_toggle_darkmode" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" <-% theme.fab_show_darkmode_button ? "" : "style='display: none;'"  aria-label="Toggle Darkmode" tooltip-darkmode="夜间模式" tooltip-blackmode="暗黑模式" tooltip-lightmode="日间模式">
		<span class="btn-inner--icon"><i class="fa fa-moon-o"></i><i class='fa fa-lightbulb-o'></i></span>
	</button>
	<button id="fabtn_toggle_blog_settings_popup" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" <-% theme.fab_show_settings_button ? "" : "style='display: none;'"  aria-label="Open Blog Settings Menu" tooltip="设置">
		<span class="btn-inner--icon"><i class="fa fa-cog"></i></span>
	</button>
	<div id="fabtn_blog_settings_popup" class="card shadow-sm" style="opacity: 0;" aria-hidden="true">
		<div id="close_blog_settings"><i class="fa fa-close"></i></div>
		<div class="blog-setting-item mt-3">
			<div style="transform: translateY(-4px);"><div id="blog_setting_toggle_darkmode_and_amoledarkmode" tooltip-switch-to-darkmode="切换到夜间模式" tooltip-switch-to-blackmode="切换到暗黑模式"><span>夜间模式</span><span>暗黑模式</span></div></div>
			<div style="flex: 1;"></div>
			<label id="blog_setting_darkmode_switch" class="custom-toggle">
				<span class="custom-toggle-slider rounded-circle"></span>
			</label>
		</div>
		<div class="blog-setting-item mt-3">
			<div style="flex: 1;">字体</div>
			<div>
				<button id="blog_setting_font_sans_serif" type="button" class="blog-setting-font btn btn-outline-primary blog-setting-selector-left">Sans Serif</button><button id="blog_setting_font_serif" type="button" class="blog-setting-font btn btn-outline-primary blog-setting-selector-right">Serif</button>
			</div>
		</div>
		<div class="blog-setting-item mt-3">
			<div style="flex: 1;">阴影</div>
			<div>
				<button id="blog_setting_shadow_small" type="button" class="blog-setting-shadow btn btn-outline-primary blog-setting-selector-left">浅阴影</button><button id="blog_setting_shadow_big" type="button" class="blog-setting-shadow btn btn-outline-primary blog-setting-selector-right">深阴影</button>
			</div>
		</div>
		<div class="blog-setting-item mt-3 mb-3">
			<div style="flex: 1;">滤镜</div>
			<div id="blog_setting_filters" class="ml-3">
				<button id="blog_setting_filter_off" type="button" class="blog-setting-filter-btn ml-0" filter-name="off">关闭</button>
				<button id="blog_setting_filter_sunset" type="button" class="blog-setting-filter-btn" filter-name="sunset">日落</button>
				<button id="blog_setting_filter_darkness" type="button" class="blog-setting-filter-btn" filter-name="darkness">暗化</button>
				<button id="blog_setting_filter_grayscale" type="button" class="blog-setting-filter-btn" filter-name="grayscale">灰度</button>
			</div>
		</div>
		<div class="blog-setting-item mb-3">
			<div id="blog_setting_card_radius_to_default" style="cursor: pointer;" tooltip="恢复默认">圆角</div>
			<div style="flex: 1;margin-left: 20px;margin-right: 8px;transform: translateY(2px);">
				<div id="blog_setting_card_radius"></div>
			</div>
		</div>
		
	</div>
	<button id="fabtn_open_sidebar" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-label="Open Sidebar Menu" tooltip="菜单">
		<span class="btn-inner--icon"><i class="fa fa-bars"></i></span>
	</button>
	<button id="fabtn_reading_progress" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-hidden="true" tooltip="阅读进度">
		<div id="fabtn_reading_progress_bar" style="width: 0%;"></div>
		<span id="fabtn_reading_progress_details">0%</span>
	</button>
</div>

<div id="content" class="site-content">


<div class="page-information-card-container">
	
</div>

<div id="sidebar_mask"></div>
<aside id="leftbar" class="leftbar widget-area" role="complementary">
		
		<div id="leftbar_part1" class="widget widget_search card bg-white shadow-sm border-0">
			<div class="leftbar-banner card-body">
				<span class="leftbar-banner-title text-white">Xjn´s Blog</span>
				
				
			</div>
			
			
				<ul id='leftbar_part1_menu' class='leftbar-menu'>
					
				</ul>
			
			<div class="card-body text-center leftbar-search-button">
				<button id="leftbar_search" class="btn btn-secondary btn-lg active btn-sm btn-block border-0" role="button" data-toggle="modal" data-target="#argon_search_modal" >
					<i class="menu-item-icon fa fa-search mr-0"></i> 搜索
				</button>
			</div>
		</div>
		<div id="leftbar_part2" class="widget widget_search card bg-white shadow-sm border-0">
			<div id="leftbar_part2_inner" class="card-body">
				
				<div class="nav-wrapper" style="padding-top: 5px;">
	                <ul class="nav nav-pills nav-fill" role="tablist">
						
							<li class="nav-item sidebar-tab-switcher">
								<a class="active show" id="leftbar_tab_catalog_btn" data-toggle="tab" href="#leftbar_tab_catalog" role="tab" aria-controls="leftbar_tab_catalog" no-pjax>文章目录</a>
							</li>
						
						<li class="nav-item sidebar-tab-switcher">
							<a class="" id="leftbar_tab_overview_btn" data-toggle="tab" href="#leftbar_tab_overview" role="tab" aria-controls="leftbar_tab_overview" no-pjax>站点概览</a>
						</li>
	                </ul>
				</div>
				<div>
					<div class="tab-content" style="padding: 10px 10px 0 10px;">
						
							<div class="tab-pane fade active show" id="leftbar_tab_catalog" role="tabpanel" aria-labelledby="leftbar_tab_catalog_btn">
								<div id="leftbar_catalog"></div>
								<script type="text/javascript">
									$(function () {
										$(document).headIndex({
											articleWrapSelector: '#post_content',
											indexBoxSelector: '#leftbar_catalog',
											subItemBoxClass: "index-subItem-box",
											itemClass: "index-item",
											linkClass: "index-link",
											offset: 80,
										});
									})
								</script>
								
							</div>
						
						<div class="tab-pane fade text-center" id="leftbar_tab_overview" role="tabpanel" aria-labelledby="leftbar_tab_overview_btn">
							<img id="leftbar_overview_author_image" src="/assets/img/auther.jpg" class="img-fluid rounded-circle shadow-sm" style="width: 100px;" alt="avatar">
							<h6 id="leftbar_overview_author_name">xjn819</h6>
							<nav class="site-state">
								<div class="site-state-item site-state-posts">
									<a href="/archives">
										<span class="site-state-item-count">3</span>
										<span class="site-state-item-name">文章</span>
									</a>
								</div>
								<div class="site-state-item site-state-categories">
									<a data-toggle="modal" data-target="#blog_categories">
										<span class="site-state-item-count">1</span>
										<span class="site-state-item-name">分类</span>
									</a>
								</div>      
								<div class="site-state-item site-state-tags">
									<a data-toggle="modal" data-target="#blog_tags">
										<span class="site-state-item-count">2</span>
										<span class="site-state-item-name">标签</span>
									</a>
								</div>
							</nav>
							
									<div class="site-author-links">
										
									</div>
								
							
									<div class='site-friend-links'>
										<div class='site-friend-links-title'><i class='fa fa-fw fa-link'></i> Links</div>
										<ul class='site-friend-links-ul'>
											
												<li class='site-friend-links-item'>
													<a href='https://blog.daliansky.net' rel='noopener' target='_blank'>黑果小兵的部落阁</a>
												</li>
											
												<li class='site-friend-links-item'>
													<a href='https://blog.tlhub.cn/' rel='noopener' target='_blank'>套陆的部落阁</a>
												</li>
											
												<li class='site-friend-links-item'>
													<a href='https://www.bugprogrammer.me/' rel='noopener' target='_blank'>Bugprogrammer的博客</a>
												</li>
											
												<li class='site-friend-links-item'>
													<a href='https://www.insanelymac.com/' rel='noopener' target='_blank'>InsanelyMac</a>
												</li>
											
												<li class='site-friend-links-item'>
													<a href='https://hyejeong.cn/' rel='noopener' target='_blank'>针针小站</a>
												</li>
											
										</ul>
									</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
</aside>
<div class="modal fade" id="blog_categories" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">分类</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<a class="badge badge-secondary tag" href="/categories/Hackintosh/" rel="tag">Hackintosh <span class="tag-num">3</span></a>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="blog_tags" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">标签</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<a class="badge badge-secondary tag" href="/tags/Hackintosh/" rel="tag">Hackintosh <span class="tag-num">3</span></a><a class="badge badge-secondary tag" href="/tags/OpenCore/" rel="tag">OpenCore <span class="tag-num">3</span></a>
			</div>
		</div>
	</div>
</div>

<div id="primary" class="content-area">
	<main id="main" class="site-main" role="main">
		
		
			
	<article class="post post-full card bg-white shadow-sm border-0 ">
	<header class="post-header text-center">
		
		<a class="post-title" href="/post/opencore-guide.html">使用 OpenCore 引导黑苹果</a>
		<div class="post-meta">
			
						
						<div class="post-meta-detail post-meta-detail-time">
							<i class="fa fa-clock-o" aria-hidden="true"></i>
							<time title="发布于 2020-10-29 22:42:50 | 编辑于 2020-11-18 20:08:17">2020-10-29 22:42
							</time>
						</div>
					
						
							<div class="post-meta-devide">|</div>
						
						<div class="post-meta-detail post-meta-detail-categories">
							<i class="fa fa-bookmark-o" aria-hidden="true"></i>
							<a class="post-meta-detail-catagory-link" href="/categories/Hackintosh/">Hackintosh</a>
						</div>
					
						
							<div class="post-meta-devide">|</div>
						
						<div class="post-meta-detail post-meta-detail-words">
							<i class="fa fa-file-word-o" aria-hidden="true"></i>
							11.8k 字
						</div>
					
						
							<div class="post-meta-devide">|</div>
						
						<div class="post-meta-detail post-meta-detail-readingtime">
							<i class="fa fa-hourglass-end" aria-hidden="true"></i>
							51 分钟
						</div>
					
		</div>
		
	</header>

	<div class="post-content" id="post_content">
		<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>OpenCore(OC) 是一种新的引导方式，越来越多的 kexts 开始放弃 Clover, 我相信提早使用 OC 会对你未来使用黑苹果会有很大的帮助。这是一个自然的现象，就像变色龙被 Clover 淘汰，而现在 OC 代替 Clover 也是大势所趋。你应该需要看一些相关的文章，来帮助你理解我的正文内容，同时也需要下载我推荐的软件。</p>
<hr>
<h2 id="阅读"><a href="#阅读" class="headerlink" title="阅读"></a>阅读</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://khronokernel-2.gitbook.io/opencore-vanilla-desktop-guide/">Opencore Vanilla Desktop Guide</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/khronokernel/Getting-Started-With-OpenCore">Getting Started With OpenCore</a></p>
</li>
</ul>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.daliansky.net/OpenCore-BootLoader.html">精解OpenCore</a></li>
</ul>
<hr>
<h2 id="软件下载"><a href="#软件下载" class="headerlink" title="软件下载"></a>软件下载</h2><ul>
<li><p>Xcode （从 App Store 或  <a target="_blank" rel="noopener" href="https://developer.apple.com/">Apple Developer</a> 下载，强烈建议使用 v10 版本的 Xcode，v11 花里胡哨已经劝退=。=)</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/corpnewt/ProperTree">ProperTree</a> 最新推荐的 config 编辑器</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/williambj1/OpenCore-Factory/releases">OpenCore</a> (由 @BAT 维护的每日工厂版，尝鲜用户可以下载这个)</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/acidanthera/OpenCorePkg/releases">OpenCore</a>（官方稳定版本）</p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://headsoft.com.au/download/mac/Hackintool.zip">Hackintool</a></p>
</li>
<li><p><a href="http://blog.xjn819.com/wp-content/uploads/2019/10/MaciASL.zip">MaciASL</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/daliansky/OC-little">宪武大大oc部件</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/acidanthera/gfxutil/releases">gfxutil</a></p>
</li>
</ul>
<hr>
<h2 id="更新日记"><a href="#更新日记" class="headerlink" title="更新日记"></a>更新日记</h2><details>
  <summary><font color=red>点击查询帖子最近更新</font></summary>

<h3 id="2020-11-02"><a href="#2020-11-02" class="headerlink" title="2020-11-02"></a>2020-11-02</h3><p>适配OpenCore 0.6.3</p>
<ul>
<li>增加ForceResolution</li>
<li>增加ForceSecureBootScheme</li>
<li>增加CustomMemory</li>
</ul>
<h3 id="2020-10-14"><a href="#2020-10-14" class="headerlink" title="2020-10-14:"></a>2020-10-14:</h3><p>1.Opencore 0.6.2 正式版修改如下 variables:</p>
<ul>
<li>增加 ExtendBTFeatureFlags （章节2.4.6）</li>
<li>移除 DummyPowerManagement（章节2.4.6）</li>
<li>增加 LegacyCommpage（章节2.4.6）</li>
<li>增加 SystemMemoryStatus （章节2.7.2）</li>
<li>增加 ProcessorType（章节2.7.2）</li>
</ul>
</details>

<hr>
<h2 id="0-0-BIOS设置"><a href="#0-0-BIOS设置" class="headerlink" title="0.0 BIOS设置"></a>0.0 BIOS设置</h2><p>直接抄袭 @BAT 了</p>
<ul>
<li><strong>禁用:</strong></li>
</ul>
<table>
<thead>
<tr>
<th align="center">英文</th>
<th align="center">中文</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Fast Boot</td>
<td align="center">快速启动</td>
</tr>
<tr>
<td align="center">CFG Lock (MSR 0xE2 write protection)</td>
<td align="center">CFG 锁 (MSR 0xE2 写入保护)</td>
</tr>
<tr>
<td align="center">VT-d</td>
<td align="center"><a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/495526512.html">VT-d</a></td>
</tr>
<tr>
<td align="center">CSM</td>
<td align="center">兼容性支持模块</td>
</tr>
<tr>
<td align="center">Intel SGX</td>
<td align="center">Intel SGX</td>
</tr>
</tbody></table>
<hr>
<ul>
<li><strong>启用:</strong></li>
</ul>
<table>
<thead>
<tr>
<th align="center">英文</th>
<th align="center">中文</th>
</tr>
</thead>
<tbody><tr>
<td align="center">VT-x</td>
<td align="center"><a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/495526512.html">VT-x</a></td>
</tr>
<tr>
<td align="center">Above 4G decoding</td>
<td align="center">大于 4G 地址空间解码</td>
</tr>
<tr>
<td align="center">Hyper Threading</td>
<td align="center">处理器超线程</td>
</tr>
<tr>
<td align="center">Execute Disable Bit</td>
<td align="center">执行禁止位</td>
</tr>
<tr>
<td align="center">EHCI/XHCI Hand-off</td>
<td align="center">接手 EHCI/XHCI 控制</td>
</tr>
<tr>
<td align="center">OS type: Windows 8.1/10</td>
<td align="center">操作系统类型: Windows 8.1/10</td>
</tr>
<tr>
<td align="center">Legacy RTC Device</td>
<td align="center">传统 RTC 设备</td>
</tr>
</tbody></table>
<blockquote>
<p>将操作系统类型设置为 <code>Windows 8.1/10</code> 是因为部分主板在 <code>Other</code> 模式下会将系统认作是 Windows 7 从而禁用 UEFI 的某些功能并开启 CSM, 200 系及以后的主板理论上不存在这个问题</p>
</blockquote>
<hr>
<h2 id="1-0-整理OPENCORE目录"><a href="#1-0-整理OPENCORE目录" class="headerlink" title="1.0 整理OPENCORE目录"></a>1.0 整理OPENCORE目录</h2><p>打开下载好的最新版 OC，把 Doc 文件夹下面的 <code>Sample.plist</code> 改名为 <code>config.plist</code>，并把此文件移动到 EFI 目录下面。<br>打开 <code>EFI--Kexts</code>，我们把常用的一些 kexts 先放进去，一般情况下你需要放如下 Kexts:</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/acidanthera/Lilu/releases">Lilu.kext</a>  Acidanthera驱动全家桶的SDK</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/acidanthera/AppleALC/releases">Applealc.kext</a>   声卡驱动</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/acidanthera/virtualsmc/releases">VirtualSMC.kext</a>    传感器驱动依赖</p>
</li>
<li><p>SMCProcessor.kext   CPU核传感器</p>
</li>
<li><p>SMCSuperIO.kext    IO传感器         </p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/acidanthera/whatevergreen/releases">WhateverGreen.kext</a> 显卡驱动</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/acidanthera/IntelMausi/releases">IntelMausi.kext</a>  Intel类千兆网卡驱动</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/Sniki/OS-X-USB-Inject-All/releases">Usbinjectall.kext</a>  USB驱动 （你也可以定制自己的USB补丁）
               </p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/acidanthera/NVMeFix/releases">NVMeFix.kext</a>      为NVME硬盘增加ASPT属性来保证节电，虽然对台式机没啥用，但是官方推荐所有NVME用户都使用此补丁</p>
</li>
</ul>
<blockquote>
<p>一些机型用了 <code>1820A,1560,1830</code> 等网卡，需要自己放对应驱动；有线螃蟹卡也自己放一下驱动；笔记本类需要更多传感器的，请自行补齐 <code>VirtualSMC</code> 的那些传感器补丁</p>
</blockquote>
<hr>
<p>打开<code>EFI--Drives</code>,里面的驱动介绍如下：</p>
<ul>
<li><p>AudioDxe.efi           开机UEFI界面若需要声音效果需要加载。</p>
</li>
<li><p>CrScreenshotDxe.efi    开机UEFI的截图工具。</p>
</li>
<li><p>HiiDatabase.efi        用于给 Ivy Bridge (3 代酷睿) 或更老代主板上支持 UEFI 字体渲染, UEFI Shell 中文字渲染异常时使用, 新主板不需要。</p>
</li>
<li><p>NvmExpressDxe.efi      用于在 Haswell (4 代酷睿) 或更老的主板上支持 NVMe 硬盘, 新主板不需要。</p>
</li>
<li><p>OpenCanopy.efi         加载第三方开机主题。</p>
</li>
<li><p>OpenRuntime.efi        内存运用等必要的插件，必须加载。 </p>
</li>
<li><p>OpenUsbKbDxe.efi       给使用模拟 UEFI 的老主板在 OpenCore 界面正常输入用的, 请勿在 Ivy Bridge (3 代酷睿)及以上的主板上使用。</p>
</li>
<li><p>Ps2KeyboardDxe.efi     PS2键盘所需插件。</p>
</li>
<li><p>Ps2MouseDxe.efi        PS2鼠标所需插件。</p>
</li>
<li><p>UsbMouseDxe.efi        当MacOS被安装在虚拟机上所需要的鼠标插件。</p>
</li>
<li><p>XhciDxe.efi            用于在 Sandy Bridge（2代）及之前或更老的主板上加载XHCI控制器。</p>
</li>
<li><p><a href="/tools/HfsPlus.efi.zip">HfsPlus.efi</a>            用于HFS格式文件系统，这是必须加载的。</p>
</li>
</ul>
<hr>
<h2 id="2-0-Config-plist-修改"><a href="#2-0-Config-plist-修改" class="headerlink" title="2.0 Config.plist 修改"></a>2.0 Config.plist 修改</h2><p>这章会把 config 的项目分开来，内容繁琐，为了让小白明白各个选项的用途。当然有能力的人可以直接看我最前面的几个链接来配置 <code>config.plist</code>。我这里强制要求你使用 <code>Propertree</code> 来编辑 <code>Config.plist</code>，其他的任何软件我都不建议使用。</p>
<hr>
<h3 id="2-1-Config–ACPI"><a href="#2-1-Config–ACPI" class="headerlink" title="2.1 Config–ACPI"></a>2.1 Config–ACPI</h3><p>ACPI包括了四个部分：<code>Add</code>, <code>Block</code>, <code>Patch</code>, <code>Quirks</code>。这里我们先把root下面的几条 <code>#WARNING</code> 删除，这几条没有实际意义。</p>
<hr>
<h3 id="2-1-1-Config–ACPI–Add"><a href="#2-1-1-Config–ACPI–Add" class="headerlink" title="2.1.1 Config–ACPI–Add"></a>2.1.1 Config–ACPI–Add</h3><p>这部分主要填写我们使用的 SSDT 以及 DSDT 文件，如果没有请把 0-8 的 ssdt 全部删除。如果你有修改的 SSDT 或者 DSDT 文件，请先将文件放入 <code>EFI/OC/ACPI</code> 下。</p>
<p>因为我使用雷电卡，我需要添加两条关于雷电卡的 ssdt 文件：</p>
<pre><code class="xml">Item 0
Comment    String       Thunderbolt3-DTGP //填一个你自己能辨别的名字，方便知道是啥
Enable     Boolean      YES                //表示加载此SSDT，反之NO则为不加载
Path       String       SSDT-DTGP.aml    //为你ssdt放在EFI/OC/ACPI下的文件名，必须一致

Item 1
Comment    String       Thunderbolt3
Enable     Boolean      YES
Path       String       SSDT-TB3.aml</code></pre>
<hr>
<h3 id="2-1-2-Config–ACPI–Delete"><a href="#2-1-2-Config–ACPI–Delete" class="headerlink" title="2.1.2 Config–ACPI–Delete"></a>2.1.2 Config–ACPI–Delete</h3><p>这个目录下是禁用一些 SSDT/DSDT，没什么用，我把下面的 <code>item</code> 全都删了。</p>
<hr>
<h3 id="2-1-3-Config–ACPI–Patch"><a href="#2-1-3-Config–ACPI–Patch" class="headerlink" title="2.1.3 Config–ACPI–Patch "></a>2.1.3 Config–ACPI–Patch <a id="2.1.3"></a></h3><p>这里我们需要填写一下热补丁。</p>
<ul>
<li>10.15及以上系统，<a target="_blank" rel="noopener" href="https://blog.daliansky.net/Common-problems-and-solutions-in-macOS-Catalina-10.15-installation.html">一些资料</a>指出我们需要把EC控制器(EC0)改名为EC来确保能进入10.15系统</li>
</ul>
<pre><code class="xml">Comment:            EC0 to EC
Count:                0
Enabled:            YES
Find:                &lt;4543305F&gt;
Limit:                0
Mask:                &lt;&gt;
OemTable:            &lt;&gt;
Replace:            &lt;45435F5F&gt;
ReplaceMask:        &lt;&gt;
Skip:                0
TableLength:        0
TableSignature:        &lt;&gt;</code></pre>
<blockquote>
<p>一些主板的EC控制器名字可能会叫 H_EC 等，请自行提取 DSDT 并搜索  <code>PNP0C09</code>，来获取 EC 控制器的名字，这些内容会在第三章中写出。</p>
</blockquote>
<hr>
<ul>
<li>华擎、华硕、微星主板可能会遇到采用新的 <code>AWAC</code> 时钟而无法进入系统，这同样需要添加  <code>hotpatch</code> 补丁来解决：</li>
</ul>
<pre><code class="xml">Comment:            RTC fix
Count:                0
Enabled:            YES
Find:                &lt;A00A9353 54415301&gt;
Limit:                0
Mask:                &lt;&gt;
OemTable:            &lt;&gt;
Replace:            &lt;A00A910A FF0BFFFF&gt;
ReplaceMask:        &lt;&gt;
Skip:                0
TableLength:        0
TableSignature:        &lt;&gt;</code></pre>
<hr>
<h3 id="2-1-4-Config–ACPI–Quirks"><a href="#2-1-4-Config–ACPI–Quirks" class="headerlink" title="2.1.4 Config–ACPI–Quirks"></a>2.1.4 Config–ACPI–Quirks</h3><p>此目录下有五项，选择与解释如下：</p>
<ul>
<li><strong>FadtEnableReset:</strong> <code>NO</code><ul>
<li>旧的主板需要对 FADT 进行标记来激活电脑的开机和关机功能，这里我们不许要启动它</li>
</ul>
</li>
<li><strong>NormalizeHeaders:</strong> <code>NO</code><ul>
<li>清理 ACPI 头，一些主板的 ACPI 表需要打开这个修复 10.13 系统的启动。</li>
</ul>
</li>
<li><strong>RebaseRegions:</strong> <code>YES</code><ul>
<li>尝试试探性地重新定位 ACPI 内存区域, <strong>使用自定义 DSDT 则必须开启</strong></li>
</ul>
</li>
<li><strong>ResetHwSig:</strong> <code>NO</code><ul>
<li>存在重新启动后因无法维持硬件签名而导致从休眠中唤醒的问题的硬件需要开启</li>
</ul>
</li>
<li><strong>ResetLogoStatus:</strong> <code>NO</code><ul>
<li>无法在有 <code>BGRT</code> 表的系统上显示 OEM Windows 标志的硬件需要开启</li>
</ul>
</li>
</ul>
<hr>
<h2 id="2-2-Config–Booter"><a href="#2-2-Config–Booter" class="headerlink" title="2.2 Config–Booter"></a>2.2 Config–Booter</h2><p>内存相关选项设置。</p>
<hr>
<h3 id="2-2-1-Config–Boot–MmioWhitelist"><a href="#2-2-1-Config–Boot–MmioWhitelist" class="headerlink" title="2.2.1 Config–Boot–MmioWhitelist"></a>2.2.1 Config–Boot–MmioWhitelist</h3><ul>
<li><p>默认的第一项是为 Haswell 芯片提供的内存寻址修复，如果此类芯片碰到内存相关问题，请开启它(<code>enable</code>选择<code>yes</code>)。</p>
</li>
<li><p>默认第二项是开机卡 <code>PCI Configuration</code> 这里。ACPI、PCI device 同时释放到内存时发生 <code>0x1000</code> 内存地址被占用而卡在 <code>PCI Configration</code>，如果碰到此类问题，请开启它。</p>
</li>
</ul>
<hr>
<h3 id="2-2-1-Config–Boot–Quirks"><a href="#2-2-1-Config–Boot–Quirks" class="headerlink" title="2.2.1 Config–Boot–Quirks"></a>2.2.1 Config–Boot–Quirks</h3><p>此项与 <code>OpenRuntime.efi</code> 有关。在 <code>aptiomemoryfix</code> 停更后，此补丁已经更名为 <code>Openruntime</code>, 并将一些功能与 OC 合并、模块化。对于无法原生 <code>nvram</code> 的主板来说，这里的选项需要格外注意。当然我也会把像 300/400 系列、x299、C246、C422 这样支持原生 <code>nvram</code> 的选择方法一并写进去。</p>
<ul>
<li><p><strong>AvoidRuntimeDefrag:</strong> <code>YES</code></p>
<ul>
<li>大部分UEFI都会写入时间、电源管理等信息，这个所有黑苹果主板都应该选择 <code>YES</code>。</li>
</ul>
</li>
<li><p><strong>DevirtualiseMmio:</strong> <code>YES</code></p>
<ul>
<li>内存注入方式包括 <code>KASLR</code> 方式(分布式注射到各个内存地址中）以及连续性方式。在使用 <code>KASLR</code> 时，PCIe 加载到内存，可能会占据所有 <code>avaliable</code> 值而影响 OC 的内核以及内核缓存无法注入，导致启动失败。此项目前建议选择YES，并且在下一项 <code>ProtectUefiServices</code> 中也选择 <code>YES</code>。</li>
</ul>
</li>
</ul>
<blockquote>
<p><code>KASLR</code> 是更加高效的内存注入方式，但不代表每台机器都能使用这种方案，这里我提供两种关于内存的设置：</p>
</blockquote>
<blockquote>
<p>1：<code>DevirtualiseMmio</code>选择<code>yes</code>, <code>ProtectUefiServices</code>选择<code>yes</code>, 并删除 <a href="#2.6.1">2.6.1</a> 中 <code>boot-args</code> 里面的<code>slide=1</code>,以及删除 Drivers 文件夹下的 <code>Memoryallocations.efi</code>。即开启 <code>KASLR</code> 内存注入方式。  </p>
</blockquote>
<blockquote>
<p>2：<code>DevirtualiseMmio</code>选择<code>yes</code>, <code>ProtectUefiServices</code>选择<code>no</code>, 保留 <a href="#2.6.1">2.6.1</a> 中 <code>boot-args</code> 里面的<code>slide=1</code>,以及保留 Drivers 文件夹下的 <code>Memoryallocations.efi</code>。即开启连续性内存注入方式。</p>
</blockquote>
<ul>
<li><p><strong>DisableSingleUser:</strong> <code>NO</code></p>
<ul>
<li>这里关乎主机是否能开启单用户模式。什么是单用户模式，请看<a target="_blank" rel="noopener" href="https://support.apple.com/zh-cn/HT201573">此文章</a>。</li>
</ul>
</li>
<li><p><strong>DisableVariableWrite:</strong> <code>YES</code></p>
<ul>
<li>非原生NVRAM主板需要模拟 <code>nvram.plist</code> 进而写入 <code>variable</code> 值，因此我们要禁止此项来防止其他程序对 <code>nvram</code> 进行写入，我们这里选 <code>YES</code>。需要注意一点，如果你的主板支持原生 <code>nvram</code>，请选择 <code>NO</code>！</li>
</ul>
</li>
<li><p><strong>DiscardHibernateMap:</strong> <code>NO</code></p>
<ul>
<li>电脑从休眠(hibernation)中唤醒时,硬盘里的资料会恢复到内存中去，但这个时候 OC 的内核以及内核缓存等也会写入，这样可能导致冲突，这个选项是帮助我们解决这个问题的。而目前来看，除了原生 <code>NVRAM</code> 都无法进行休眠（注意睡眠 <code>sleep</code> 和休眠 <code>hibernation</code> 是两个概念），台式机的话就更不需要休眠功能了，这里我选择 <code>NO</code>。这里我们也不讨论如何休眠。</li>
</ul>
</li>
<li><p><strong>EnableSafeModeSlide:</strong> <code>YES</code></p>
<ul>
<li>安全模式下是否启用连续性的内存注入方式。我就选择 <code>YES</code>，与正常情况下保持一致。</li>
</ul>
</li>
<li><p><strong>EnableWriteUnprotector:</strong> <code>YES</code></p>
<ul>
<li>保证 <code>nvram</code> 能正常写入而不受到 <code>CR0</code> 寄存器的写入保护影响。</li>
</ul>
</li>
<li><p><strong>ForceExitBootServices:</strong> <code>NO</code></p>
<ul>
<li>这个选项是让那些非常老旧的主板也能使用内存寻址，正常情况下选 <code>NO</code>。</li>
</ul>
</li>
<li><p><strong>ProtectMemoryRegions:</strong> <code>NO</code></p>
<ul>
<li>官方对此项目的解释与 <code>AvoidRuntimeDefrag</code> 类似，除非你明白这是什么，不然选择 <code>NO</code>，其实我也不明白。</li>
</ul>
</li>
<li><p><strong>ProtectSecureBoot:</strong> <code>NO</code></p>
<ul>
<li>保护安全启动，除非你开启安全启动，不然我们选择 <code>NO</code>。</li>
</ul>
</li>
<li><p><strong>ProtectUefiServices:</strong> <code>NO</code></p>
<ul>
<li>解决Z390系列主板卡开机卡++++的问题，这个功能从字面意思是与我提供的 <code>memoryallocation.efi</code>功能类似。</li>
</ul>
</li>
<li><p><strong>ProvideCustomSlide:</strong> <code>YES</code></p>
<ul>
<li>此选项执行固件的内存映射分析并检查所有的 <code>slide</code> 值(1 - 255)是否可用。由于 <code>boot.efi</code> 生成的这个值是利用 <code>rdrand</code> 指令随机生成的或者伪随机指令 <code>rdtsc</code> 随机生成的，因此当其选择了 一个冲突的 <code>slide</code> 值时有可能启动失败。由于这种潜在的冲突存在，此选项强制 macOS 在可用的值中使用一个伪随机值，这也确保了 <code>slide= </code>启动参数不会因为安全原因传递给操作系统。<br>是否需要此选项由信息 OCABC (Only N/256 slide values are usable!) 是否存在于调试日 志中决定。如果存在此信息，则需要启用此 <code>Quriks</code> 选项。我选择 <code>YES</code>。如果你对 <code>KASLR</code>有一定的认知并会运用，请注意这个值。内容从 @套陆 摘抄。</li>
</ul>
</li>
<li><p><strong>ProvideMaxSlide:</strong> <code>0</code></p>
<ul>
<li>如果你没有启用 <code>KASLR</code> 的话，请填写 <code>1-255</code> 之间的数字以存放休眠文件写进内存所需要的内存高度，反之则填写 <code>0</code>。</li>
</ul>
</li>
<li><p><strong>RebuildAppleMemoryMap:</strong> <code>NO</code></p>
<ul>
<li>重新生成内存地图来匹配苹果系统。苹果的内核有很多缺陷，比如单张的内存地图不能超过 4K，一旦超过就可能无法开机；又比如一些硬件会直接把读写权限写进内存里，而苹果却不能给与写入权限。如果你遇到此类的问题，请尝试开启它。注意此项目与 <code>EnableWriteUnprotector</code> 存在冲突关系，确保开启这个的时候，另一个是关闭的。另外，此项又需要与 <code>SyncRuntimePermissions</code> 项搭配使用。一般情况下请选择 <code>NO</code>。</li>
</ul>
</li>
<li><p><strong>SetupVirtualMap:</strong> <code>YES</code></p>
<ul>
<li>是否建立虚拟内存并对物理内存进行映射。我们在开机时，OC 的程序需要一块连续性的内存进行存放内核等东西，而实际的物理内存一般都是分散的。因此，我们通过虚拟内存建立连续性内存供OC使用，并映射到分散的物理内存中。这里我们选择 <code>YES</code>。</li>
</ul>
</li>
<li><p><strong>SignalAppleOS:</strong> <code>NO</code></p>
<ul>
<li>通知同一台电脑上的设备 Mac 上的硬件选择，此项是给白苹果用的。</li>
</ul>
</li>
</ul>
<ul>
<li><strong>SyncRuntimePermissions:</strong> <code>YES</code><ul>
<li>修正硬件在注入内存时无法注入权限的问题。一般此类问题存在2018年后的主板。如果你因为此选项无法进入 windows，请开启它。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="2-3-Config–DeviceProperties"><a href="#2-3-Config–DeviceProperties" class="headerlink" title="2.3 Config–DeviceProperties"></a>2.3 Config–DeviceProperties</h2><p>此项是用来注入你的设备的，主要是显卡和声卡两部分。同样你也可以定制一些设备到你的 <code>关于本机--系统报告--PCI</code> 列表中，尽管没有多大的意义。</p>
<h3 id="2-3-1-声卡"><a href="#2-3-1-声卡" class="headerlink" title="2.3.1 声卡 "></a>2.3.1 声卡 <a id=2.3.1></a></h3><p>这里首先我们需要确认自己的声卡驱动已经被加载，终端下输入：</p>
<pre><code class="bash">kextstat | grep -E &quot;AppleHDA|AppleALC|Lilu&quot;</code></pre>
<p>我们会得到被加载的驱动，请确保 <code>as.vit9696.Lilu</code>；<code>as.vit9696.AppleALC</code>；<code>com.apple.driver.AppleHDAController</code>；<code>com.apple.driver.AppleHDA</code> 已经被加载。</p>
<p>找自己声卡的地址，准备好在文章开头要求下载的 <code>gfxutil</code>，将 <code>gfxutil</code> 程序放在桌面，输入:</p>
<pre><code class="bash">~/desktop/gfxutil -f HDEF //一般来说我们在使用 Applealc 后，板载声卡的部件名都叫 HDEF</code></pre>
<p>我们输入后会得到声卡的PCI路径，比如我输出的就是：</p>
<pre><code class="bash">00:1f.3 8086:a2f0 /PC00@0/HDEF@1F,3 = PciRoot(0x0)/Pci(0x1F,0x3)</code></pre>
<p>这里我们找到的声卡 PCI 路径为 <code>PciRoot(0x0)/Pci(0x1f,0x3)</code>。我们把预先填写在那里的 <code>PciRoot(0x0)/Pci(0x1b,0x0)</code> 项替换成我们真正的声卡路径。</p>
<p>后面一段我们看到预先填写的声卡ID为 <code>&lt;01000000&gt;</code>，这里我们需要把它换成合适自己声卡的 ID，输入以下命令得到自己声卡的 CodecID。</p>
<pre><code class="bash">ioreg -l|grep IOHDACodecVendorID</code></pre>
<p>点击<a target="_blank" rel="noopener" href="https://github.com/headkaze/Hackintool/blob/master/Resources/Audio/Codecs.plist">此页面</a>搜索刚得到的CodecID就可查询到自己声卡的型号名称，以及可用的 <code>LayoutID</code>。</p>
<p>比如我的 CodecID 为 <code>283906408</code>，声卡型号 <code>ALCS1220A</code>，对应 1, 2, 3, 5, 7, 11, 13, 15, 16, 27, 28, 29, 34 的 <code>layout ID</code>。我们需要一个个测试过去，选定自己能用的。这里我们选择 7 这个 ID 进行测试，将 7 转化成 16 进制格式为 07，后面为了满足格式要求添加 6 个 0，则为 <code>07000000</code>，将这个值替换刚才预先填的<code> 01000000</code> 中；如果我们测试 ID 为 27，27 的 16 进制为 1b，补上 6 个 0 则为 <code>1b000000</code>。</p>
<pre><code class="xml">PciRoot(0x0)/Pci(0x1f,0x3)
        device-id       data      &lt;70a10000&gt; //一般情况下这段是不需要填写的，除非你的声卡需要仿冒
        layout-id       data      &lt;0b000000&gt; //这个Layout id我瞎写的，你按实际情况写</code></pre>
<p>如果你测试的ID都无效，请确保你的操作过程正确、并测试用万能声卡(VoodooHDA)补丁来替换 AppleALC 这个补丁。如果都不行，你可能需要自行<a target="_blank" rel="noopener" href="https://blog.daliansky.net/Use-AppleALC-sound-card-to-drive-the-correct-posture-of-AppleHDA.html">编译声卡补丁</a>。</p>
<hr>
<h3 id="2-3-2-核心显卡"><a href="#2-3-2-核心显卡" class="headerlink" title="2.3.2 核心显卡"></a>2.3.2 核心显卡</h3><p>打开 <code>PciRoot(0x0)/Pci(0x2,0x0)</code> 这项，此项为驱动核心显卡。驱动核心显卡我们要分情况讨论:</p>
<ul>
<li>1.只有核心显卡的 DP 显示器用户 (HDMI我会在进阶设置中写）；</li>
<li> 2.没有核心显卡的用户；</li>
<li> 3.有核心显卡并用独显做主力的用户。</li>
</ul>
<blockquote>
<p>注意，这里我们只讨论 8代和9代CPU 的机器，其他CPU机型的请在论坛或者<a target="_blank" rel="noopener" href="https://blog.daliansky.net/Intel-core-display-platformID-finishing.html">黑果小兵博客</a>中搜索相关代码。</p>
</blockquote>
<hr>
<h4 id="2-3-2-1-只有核心显卡的DP显示器用户"><a href="#2-3-2-1-只有核心显卡的DP显示器用户" class="headerlink" title="2.3.2.1 只有核心显卡的DP显示器用户"></a>2.3.2.1 只有核心显卡的DP显示器用户</h4><p>8代和9代的核显ID为:<code>3E9b0007</code>，device ID为 <code>3e9b0000</code>，但是我们需要符合苹果的倒叙格式填入：</p>
<pre><code class="xml">AAPL,ig-platform-id        data        &lt;07009b3e&gt;
device-id                  data        &lt;9b3e0000&gt;
framebuffer-unifiedmem     data        &lt;00000080&gt;      //核显显存相关</code></pre>
<hr>
<h4 id="2-3-2-2-没核心显卡的用户"><a href="#2-3-2-2-没核心显卡的用户" class="headerlink" title="2.3.2.2 没核心显卡的用户"></a>2.3.2.2 没核心显卡的用户</h4><p>带f的cpu (e.g. 9100f 9900kf), Xeon 等不带核心显卡的用户不需要管这项，直接把 <code>AAPL,ig-platform-id</code>选项卡删了。</p>
<hr>
<h4 id="2-3-2-3-有核心显卡并用独显做主力的用户"><a href="#2-3-2-3-有核心显卡并用独显做主力的用户" class="headerlink" title="2.3.2.3 有核心显卡并用独显做主力的用户"></a>2.3.2.3 有核心显卡并用独显做主力的用户</h4><p>这种情况我们一般把核心显卡作为加速用，而显示则用独立显卡。这样，我们填一个作为加速用的核显ID即可了，8代9代10代除外的 cpu 请搜索黑果小兵的博客：</p>
<pre><code class="xml">AAPL,ig-platform-id        data        &lt;0300983e&gt;</code></pre>
<hr>
<h3 id="2-3-3-Delete"><a href="#2-3-3-Delete" class="headerlink" title="2.3.3 Delete"></a>2.3.3 Delete</h3><p>这里是禁用一些设备的，我们按默认就行了，不需要任何修改。</p>
<hr>
<h2 id="2-4-Config–Kernel"><a href="#2-4-Config–Kernel" class="headerlink" title="2.4 Config–Kernel"></a>2.4 Config–Kernel</h2><p>这里是内核相关选项。</p>
<hr>
<h3 id="2-4-1-Config–Kernel–Add"><a href="#2-4-1-Config–Kernel–Add" class="headerlink" title="2.4.1 Config–Kernel–Add"></a>2.4.1 Config–Kernel–Add</h3><p>这里我们需要填写kexts的相关资料。值得注意的是 OC 的 kexts 填写必须注意顺序，比如 applealc 的依赖是 <code>lilu.kext</code>，那么 <code>lilu.kext</code> 必须填在第一个，<code>SMCProcessor.kext</code> 依赖于 <code>Virtualsmc.kext</code>。那 <code>Virtualsmc.kext</code> 必须放在 <code>SMCProcessor.kext</code> 之前。</p>
<p>这里默认情况下很多我们需要的补丁已经被加载里面了，但是 <code>enabled</code> 那块我们要手动改成 <code>yes</code> 去开启它，把一些不用的删了：</p>
<pre><code class="xml">Item 0
      BundlePath       String         Lilu.kext            //kext的名字
      Comment          String                              //你自己填一个注释，可以不填
      Enabled          Boolean        YES                  //启动此补丁，反之则为关闭
      ExecutablePath   String         Contents/MacOS/Lilu  //通过右键kext显示包内容查找lilu运行文件的真正路径
      MaxKernel        String                              //此补丁支持的最大系统版本，填19为10.15，18位10.14；我们一般情况下留空
      MinKernel        String                              //此补丁支持的最小系统版本
      PlistPath        String         Contents/Info.plist  //kext的plist位置，可以右键kext显示包内容查找正确路径
       ............ ...........
       ............ ...........

Item 7
      BundlePath       String         USBPorts.kext
      Comment          String       
      Enabled          Boolean        YES
      ExecutablePath   String                              //一些没有执行文件的kext不需要填写
      MaxKernel        String
      MinKernel        String
      PlistPath        String         Contents/Info.plist
       ............ ...........
       ............ ...........</code></pre>
<hr>
<h3 id="2-4-2-Config–Kernel–Block"><a href="#2-4-2-Config–Kernel–Block" class="headerlink" title="2.4.2 Config–Kernel–Block"></a>2.4.2 Config–Kernel–Block</h3><p>禁用一些 kexts，这里好像没啥用，不用理会。</p>
<hr>
<h3 id="2-4-3-Config–Kernel–Emulate"><a href="#2-4-3-Config–Kernel–Emulate" class="headerlink" title="2.4.3 Config–Kernel–Emulate"></a>2.4.3 Config–Kernel–Emulate</h3><p>此选项帮助 Ivy Bridge 和一些不受支持的CPU加载电源管理的，我们这里不做此方面讨论。所有选项按默认即可。</p>
<hr>
<h3 id="2-4-4-Config–Kernel–Force"><a href="#2-4-4-Config–Kernel–Force" class="headerlink" title="2.4.4 Config–Kernel–Force"></a>2.4.4 Config–Kernel–Force</h3><p>特殊情况下我们需要强制加载某一些  <code>kext</code> 来达到某种目的，一般我们不理会此项。</p>
<hr>
<h3 id="2-4-5-Config–Kernel–Patch"><a href="#2-4-5-Config–Kernel–Patch" class="headerlink" title="2.4.5 Config–Kernel–Patch"></a>2.4.5 Config–Kernel–Patch</h3><p>这里是为内核打补丁用的，我会在进阶教程中详细写一下这一块。尤其是 rtc 相关的内容，我都会写进第三章的进阶教程。</p>
<hr>
<h3 id="2-4-6-Config–Kernel–Quirks"><a href="#2-4-6-Config–Kernel–Quirks" class="headerlink" title="2.4.6 Config–Kernel–Quirks"></a>2.4.6 Config–Kernel–Quirks</h3><p>这里是内核相关的快捷选项，比较重要。</p>
<ul>
<li><p><strong>AppleCpuPmCfgLock:</strong> <code>YES</code></p>
<ul>
<li>四代之前的 CPU，如果未解锁 CFG(即MSR0xE2) 请选择 <code>YES</code>。</li>
</ul>
</li>
<li><p><strong>AppleXcpmCfgLock:</strong> <code>YES</code></p>
<ul>
<li>四代之后的CPU若未解锁 CFG(即MSR0xE2) 请选择 <code>YES</code>。</li>
</ul>
</li>
<li><p><strong>AppleXcpmExtraMsrs:</strong> <code>NO</code></p>
<ul>
<li>主要在没有原生电源管理的CPU上启用，一般是 <code>Haswell-E</code>, <code>Broadwell-E</code>, <code>Skylake-X</code> 这三种 CPU 需要填写 <code>YES</code>。除此之外的 CPU 选择 <code>NO</code>。</li>
</ul>
</li>
<li><p><strong>AppleXcpmForceBoost:</strong> <code>NO</code></p>
<ul>
<li>开启时将电脑的 cpu 频率锁定为最高频率。</li>
</ul>
</li>
<li><p><strong>CustomSMBIOSGuid:</strong> <code>NO</code></p>
<ul>
<li>戴尔笔记本专用项。</li>
</ul>
</li>
<li><p><strong>DisableIoMapper</strong> <code>NO</code></p>
<ul>
<li>禁用 vt-d。</li>
</ul>
</li>
<li><p><strong>DisableLinkeditJettison</strong> <code>YES</code></p>
<ul>
<li>提升 <code>lilu</code> 等插件在 MACOS 11 系统的表现，用来替代 <code>keepsyms=1</code>。</li>
</ul>
</li>
<li><p><strong>DisableRtcChecksum</strong> <code>NO</code></p>
<ul>
<li>越过两条 rtc 检查 (0x58及0x59)。RTC 我们会更多地使用 <code>RTCMemoryFixup.kext</code> 来防止它。</li>
</ul>
</li>
<li><p><strong>ExtendBTFeatureFlags</strong> <code>NO</code></p>
<ul>
<li>代替 <code>BT4LEContinuityFixup.kext</code> 来实现 <code>continuity</code>。</li>
</ul>
</li>
<li><p><strong>ExternalDiskIcons</strong> <code>NO</code></p>
<ul>
<li>修复苹果系统把内部硬盘识别为外置硬盘时（黄色图标的硬盘）开启。</li>
</ul>
</li>
<li><p><strong>ForceSecureBootScheme</strong> <code>NO</code></p>
<ul>
<li>只在MacOS安装在虚拟机并开启<code>SecurebootModel</code>时考虑开启。</li>
</ul>
</li>
<li><p><strong>IncreasePciBarSize</strong> <code>NO</code></p>
<ul>
<li>解决卡 PCI configuration，一般卡 pci configuration 都是因为自己错误的设置和硬件问题。</li>
</ul>
</li>
<li><p><strong>LapicKernelPanic</strong> <code>NO</code></p>
<ul>
<li>适用于HP笔记本的内核奔溃选项。</li>
</ul>
</li>
<li><p><strong>LegacyCommpage</strong> <code>NO</code></p>
<ul>
<li>老平台主板中使用 ssse3 需要开启来使用 macOS 10.4 - 10.6。</li>
</ul>
</li>
<li><p><strong>PanicNoKextDump</strong> <code>YES</code></p>
<ul>
<li>防止 <code>kext</code> 出错打报告而让我们看不到真正的 <code>panic</code> 原因，初始排错时最好打开。</li>
</ul>
</li>
<li><p><strong>PowerTimeoutKernelPanic</strong> <code>YES</code></p>
<ul>
<li>一些设备自身的电源管理无法让系统进入睡眠而超时，导致内核奔溃，如果有这个问题请选择 <code>YES</code>。</li>
</ul>
</li>
<li><p><strong>ThirdPartyDrives</strong> <code>NO</code></p>
<ul>
<li>开启 SATA 类 SSD 的 <code>trim</code> 功能，我没有 SATA 类的 ssd，我选择 <code>NO</code>。自行根据情况选择。</li>
</ul>
</li>
<li><p><strong>XhciPortLimit</strong> <code>YES</code></p>
<ul>
<li>解除 15 个 USB 端口限制</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-4-7-Config–Kernel–Scheme"><a href="#2-4-7-Config–Kernel–Scheme" class="headerlink" title="2.4.7 Config–Kernel–Scheme"></a>2.4.7 Config–Kernel–Scheme</h3><ul>
<li><strong>FuzzyMatch</strong> <code>NO</code><ul>
<li>此选项是给 10.6 以及更早的系统使用，我们不做探讨。</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>KernelArch</strong> <code>NO</code></p>
<ul>
<li>此选项是给 10.7 以及更早的系统使用，不做探讨，直接填写默认的 <code>x86_64</code>。</li>
</ul>
</li>
<li><p><strong>KernelCache</strong> <code>Auto</code></p>
<ul>
<li>选择更加合适的内核缓存方式以提升启动速度。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="2-5-Config–Misc"><a href="#2-5-Config–Misc" class="headerlink" title="2.5 Config–Misc"></a>2.5 Config–Misc</h2><p>这里都是一些开机引导类的设置。</p>
<hr>
<h3 id="2-5-1-Config–Misc–BlessOverride"><a href="#2-5-1-Config–Misc–BlessOverride" class="headerlink" title="2.5.1 Config–Misc–BlessOverride"></a>2.5.1 Config–Misc–BlessOverride</h3><p>用于覆盖 Windows <code>bootmgfw.efi</code> 的位置以便识别 Windows 引导项, <code>OpenCore</code> 和 <code>Windows</code> 的引导文件在同一硬盘的同一个 ESP 分区下使用</p>
<pre><code class="XML">▼ Misc                  &lt;Dictionary&gt;
|__ ▼ BlessOverride     &lt;Array&gt;
    |__ Item 0          &lt;String&gt;          \EFI\Microsoft\Boot\bootmgfw.efi</code></pre>
<hr>
<h3 id="2-5-2-Config–Misc–Boot"><a href="#2-5-2-Config–Misc–Boot" class="headerlink" title="2.5.2 Config–Misc–Boot"></a>2.5.2 Config–Misc–Boot</h3><ul>
<li><p><strong>ConsoleAttributes</strong> <code>0</code></p>
<ul>
<li>设置开机选择界面的颜色，默认直接填 0。使用方法为填入字体颜色和背景颜色的值的 16 进制之和。例如<font color=blue>蓝色字</font> <code>(0x01)</code> + <font color=red>红色背景</font> <code>(0x40)</code> = <code>0x41</code>。色彩选择如下：</li>
</ul>
</li>
<li><p>字体颜色</p>
<ul>
<li>0x00 — <font color=black>黑</font></li>
<li>0x01 — <font color=blue>蓝</font></li>
<li>0x02 — <font color=green>绿</font></li>
<li>0x03 — <font color=cyan>青</font></li>
<li>0x04 — <font color=red>红</font></li>
<li>0x05 — <font color=crimson>艳红</font></li>
<li>0x06 — <font color=brown>棕</font></li>
<li>0x07 —  <font color=gainsboro>淡灰</font></li>
<li>0x08 — <font color=dimgray>深灰</font></li>
<li>0x09 — <font color=lightskyblue>淡蓝</font></li>
<li>0x0A — <font color=lightgreen>淡绿</font></li>
<li>0x0B — <font color=lightcyan>淡青</font></li>
<li>0x0C — <font color=lightred>淡红</font></li>
<li>0x0D — <font color=lightcrimson>淡艳红</font></li>
<li>0x0E — <font color=yellow>黄</font></li>
<li>0x0F — <font color=white>白</font>（这里是白色）</li>
</ul>
</li>
<li><p>背景颜色</p>
<ul>
<li>0x00 — <font color=black>黑</font></li>
<li>0x10 — <font color=blue>蓝</font></li>
<li>0x20 — <font color=green>绿</font></li>
<li>0x30 — <font color=cyan>青</font></li>
<li>0x40 — <font color=red>红</font></li>
<li>0x50 — <font color=crimson>艳红</font></li>
<li>0x60 — <font color=brown>棕</font></li>
<li>0x70 — <font color=gainsboro>淡灰</font></li>
</ul>
</li>
<li><p><strong>HibernateMode</strong> <code>None</code></p>
<ul>
<li><p>检测休眠模式。与系统内的休眠模式 (hibernatemode 25) 配合, 引导进系统会还原休眠前的状态, 建议关闭</p>
</li>
<li><p><code>None</code>: 关闭休眠支持</p>
</li>
<li><p><code>Auto</code>: 自动检测 RTC 和 NVRAM 模式</p>
</li>
<li><p><code>RTC</code>: RTC 模式</p>
</li>
</ul>
</li>
<li><p><strong>PickerAttributes</strong> <code>0</code></p>
<ul>
<li><p>当你使用OC主题时，你可以通过计算以下数值之和来配合使用OC主题，OC主题至今还在测试阶段。默认填 0，你可能使用到的值如下：</p>
</li>
<li><p><code>0x0004</code>: 简化主题图标下的文字</p>
</li>
<li><p><code>0x0008</code>: 使用老式的图标</p>
</li>
</ul>
</li>
<li><p><strong>PickerAudioAssist</strong> <code>NO</code></p>
<ul>
<li>是否开启开机朗读文字功能，一般选择NO，如果你要开启，请同时阅读章节2.8.2和2.8.7的相关音频设置。</li>
</ul>
</li>
<li><p><strong>PickerMode</strong> <code>Builtin </code></p>
<ul>
<li>是否使用OC的开机启动盘选项，如果我们填 <code>Builtin</code> 就是不使用任何主题；如果我们填 <code>External</code> 就会调用第三方主题。</li>
</ul>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/acidanthera/OcBinaryData">官网推荐主题下载</a><br>请将下载好的Resources件放入ESP/EFI/OC下，同时，你需要将OpenCanopy.efi放入Drivers文件夹下并加载。</p>
</blockquote>
</li>
<li><p><strong>PollAppleHotKeys</strong> <code>YES</code></p>
<ul>
<li>是否开启一些热键功能，包括 <kbd>⌘</kbd>+<kbd>K</kbd>，<kbd>⌘</kbd>+<kbd>S</kbd></li>
</ul>
</li>
<li><p><strong>ShowPicker</strong> <code>YES</code></p>
<ul>
<li>是否显示开机启动盘选项。</li>
</ul>
</li>
<li><p><strong>TakeoffDelay</strong> <code>0</code></p>
<ul>
<li>开机热键延时，如果你按热键来不及按，你可以设置5000到10000之间的值让你有更多时间按热键（毫秒）。</li>
</ul>
</li>
<li><p><strong>Timeout</strong> <code>5</code></p>
<ul>
<li>倒计时进入指定硬盘，这里我们按需求填写，我填写5，代表5秒钟进入指定硬盘。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-5-3-Config–Misc–Debug"><a href="#2-5-3-Config–Misc–Debug" class="headerlink" title="2.5.3 Config–Misc–Debug"></a>2.5.3 Config–Misc–Debug</h3><p>是否开启debug模式，这里我们暂时不需要，全部按默认设置。</p>
<hr>
<h3 id="2-5-4-Config–Misc–Entries"><a href="#2-5-4-Config–Misc–Entries" class="headerlink" title="2.5.4 Config–Misc–Entries"></a>2.5.4 Config–Misc–Entries</h3><p>这里是帮助我们添加一些你希望的引导路径，这个会在之后的进阶教程中讲，这里暂时略过不填写。</p>
<hr>
<h3 id="2-5-5-Config–Misc–Security"><a href="#2-5-5-Config–Misc–Security" class="headerlink" title="2.5.5 Config–Misc–Security"></a>2.5.5 Config–Misc–Security</h3><ul>
<li><p><strong>AllowNvramReset</strong> <code>YES</code></p>
<ul>
<li>是否在开机引导项中加入重置 <code>NVRAM</code> 功能的选项。</li>
</ul>
</li>
<li><p><strong>AllowSetDefault</strong> <code>YES</code></p>
<ul>
<li>选择 <code>yes</code> 后即可在开机选择系统页面中通过 <kbd>Ctrl</kbd>+<kbd>Enter</kbd> 键设置默认启动盘。</li>
</ul>
</li>
<li><p><strong>ApECID</strong> <code>0</code></p>
<ul>
<li>一般按默认的 0 填写，如果要开启安全启动的身份认证，请随便填写一串数字，比如手机号。</li>
</ul>
</li>
<li><p><strong>AuthRestart</strong> <code>NO</code></p>
<ul>
<li><code>Filevault</code> 相关项，选择 <code>NO</code>。</li>
</ul>
</li>
<li><p><strong>BootProtect</strong> <code>Bootstrap</code></p>
<ul>
<li>此选项能保证 <code>OPENCORE.EFI</code> 的永久性而免遭到其他操作系统对开机顺位的破坏。在填写此项后，你同样需要保证 <code>RequestBootVarRouting</code> 是开启的。</li>
</ul>
</li>
<li><p><strong>DmgLoading</strong> <code>Any</code></p>
<ul>
<li>如果你没有开启安全启动，请填写 <code>Any</code>；如果使用安全启动，请填写 <code>Signed</code>（注意大小写）。</li>
</ul>
</li>
<li><p><strong>EnablePassword</strong> <code>NO</code></p>
<ul>
<li>此选项正在开发。</li>
</ul>
</li>
<li><p><strong>ExposeSensitiveData</strong> <code>2</code></p>
<ul>
<li>模拟 <code>nvram</code>，填 3，如果你有原生 <code>nvram</code>，填写 2。</li>
</ul>
</li>
<li><p><strong>HaltLevel</strong> <code>2147483648</code></p>
<ul>
<li>按默认设置即可。</li>
</ul>
</li>
<li><p><strong>PasswordHash</strong> <code>留空</code></p>
<ul>
<li>按默认，如果开启了 <code>EnablePassword</code>，则填写密码的 <code>hash</code> 值。</li>
</ul>
</li>
<li><p><strong>PasswordSalt</strong> <code>留空</code></p>
<ul>
<li>按默认，如果开启了 <code>EnablePassword</code>，则填写密码的 <code>salt</code> 值。</li>
</ul>
</li>
<li><p><strong>ScanPolicy</strong> <code>0</code></p>
<ul>
<li>填0。我们也许会碰到开机的时候默认进入的系统永远是 WINDOWS，并无法更改，之后我们在进阶教程中讲述，如何让 MAC 盘排在第一个，让 WIN 排在后面。</li>
</ul>
</li>
<li><p><strong>SecureBootModel</strong> <code>Disabled</code></p>
<ul>
<li>是否开启安全启动模式，一般我们填写 <code>Disabled</code>（注意大小写）来关闭此功能。</li>
</ul>
</li>
<li><p><strong>Vault</strong> <code>Optional</code></p>
<ul>
<li>是否开启保险箱功能，我们选择 <code>Optional</code> 不开启它。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-5-6-Config–Misc–Tools"><a href="#2-5-6-Config–Misc–Tools" class="headerlink" title="2.5.6 Config–Misc–Tools"></a>2.5.6 Config–Misc–Tools</h3><p>用于运行 OC 调试工具, 例如验证 CFG 锁 (VerifyMsrE2)</p>
<ul>
<li><strong>Arguments</strong><ul>
<li>传递的参数</li>
</ul>
</li>
<li><strong>Auxiliary:</strong> <code>NO</code><ul>
<li><code>NO</code> 默认不隐藏</li>
</ul>
</li>
<li><strong>Name</strong> <code>名称（如 openshell ）</code><ul>
<li>OpenCore 启动项中显示的名称</li>
</ul>
</li>
<li><strong>Enabled</strong> <code>YES/NO</code><ul>
<li>启用或禁用</li>
</ul>
</li>
<li><strong>Path</strong> <code>文件名称（如 openshell.efi）</code><ul>
<li><code>Tools</code> 文件夹下的文件名</li>
</ul>
</li>
</ul>
<hr>
<h2 id="2-6-Config–NVRAM"><a href="#2-6-Config–NVRAM" class="headerlink" title="2.6 Config–NVRAM"></a>2.6 Config–NVRAM</h2><hr>
<h3 id="2-6-1-Config–NVRAM–Add"><a href="#2-6-1-Config–NVRAM–Add" class="headerlink" title="2.6.1 Config–NVRAM–Add "></a>2.6.1 Config–NVRAM–Add <a id=2.6.1></a></h3><pre><code class="xml">4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14
    UIScale                 Data       &lt;02&gt; //这里填写01为普通的UI显示模式，02为开启HIDPI的UI显示模式，我选择02
    DefaultBackgroundColor  Data       &lt;00000000&gt; //默认开机背景色为黑色

7C436110-AB2A-4BBB-A880-FE41995C9F82
    boot-args               String     Slide=1 darkwake=0 -v //slide=1 表示从第一组内存开始连续注入；darkwake=0 代表一键唤醒机器并偏好设置中节能选项的小憩功能。如果你要用小憩功能请填8； -v 是跑代码，在没装好稳定的黑果前我建议加上，方便定位错误，弄完后再删除 -v
    csr-active-config       Data       &lt;e7030000&gt; //关闭 SIP 保护
    nvda_drv                Data       &lt;31&gt; //对 10.13 系统之前的N卡的相关设置，我们不做讨论。
    prev-lang:kbd           Data       &lt;7a682d48616e733a323532&gt; //语言设置相关，记得改成这个，这个是中文

    7C436110-AB2A-4BBB-A880-FE41995C9F82 //默认就行，如果需要使用 RTC 屏蔽选项，具体参考RTC综述</code></pre>
<hr>
<h3 id="2-6-2-Config–NVRAM–Delete"><a href="#2-6-2-Config–NVRAM–Delete" class="headerlink" title="2.6.2 Config–NVRAM–Delete"></a>2.6.2 Config–NVRAM–Delete</h3><p>NVRAM的数据不可被覆盖，必须先被删除再添加，我们这里按默认设置不必理会。</p>
<hr>
<h3 id="2-6-3-Config–NVRAM–LegacySchema"><a href="#2-6-3-Config–NVRAM–LegacySchema" class="headerlink" title="2.6.3 Config–NVRAM–LegacySchema"></a>2.6.3 Config–NVRAM–LegacySchema</h3><p>这里是模拟 <code>NVRAM</code> 的变量设置，大部分默认已经填好，我们只需添加两个变量即可。</p>
<p>打开 <code>7C436110-AB2A-4BBB-A880-FE41995C9F82</code> 这一栏，添加两个item如下：</p>
<pre><code class="bash">item 11     String      efi-boot-device
item 12     String      efi-boot-device-data</code></pre>
<hr>
<h3 id="2-6-4-Config–NVRAM–LegacyEnable"><a href="#2-6-4-Config–NVRAM–LegacyEnable" class="headerlink" title="2.6.4 Config–NVRAM–LegacyEnable"></a>2.6.4 Config–NVRAM–LegacyEnable</h3><p>如果你的主板不支持原生 <code>NVRAM</code>，请一定要选择 <code>YES</code>，反之则选择 <code>NO</code>。</p>
<hr>
<h3 id="2-6-5-Config–NVRAM–WriteFlash"><a href="#2-6-5-Config–NVRAM–WriteFlash" class="headerlink" title="2.6.5 Config–NVRAM–WriteFlash"></a>2.6.5 Config–NVRAM–WriteFlash</h3><p>一般情况下我们需要选择 <code>YES</code> 来保证<code>启动磁盘</code>功能的正常使用，但开启后可能会在一段时间后导致 <code>CMOS</code> 被写满，主板无法经过自检。这样的问题请请参照<a href="https://blog.xjn819.com/post/rtc-issues-related-to-oc.html">RTC综述</a></p>
<hr>
<h3 id="2-6-6-Config–NVRAM–LegacyOverwrite"><a href="#2-6-6-Config–NVRAM–LegacyOverwrite" class="headerlink" title="2.6.6 Config–NVRAM–LegacyOverwrite"></a>2.6.6 Config–NVRAM–LegacyOverwrite</h3><p>对模拟 <code>nvram</code> 用户来说，将 <code>nvram.plist</code> 写入硬件，我认为不管是原生 <code>nvram</code> 还是模拟 <code>nvram</code>，都选择 <code>NO</code>。</p>
<hr>
<h2 id="2-7-Config–PlatformInfo"><a href="#2-7-Config–PlatformInfo" class="headerlink" title="2.7 Config–PlatformInfo"></a>2.7 Config–PlatformInfo</h2><p>这里我们填合适的机型。对于最近一代的主板来说，一般的原则，只有核显的机器我们选Macmini8,1；只有独显的机器我们选择iMac Pro 1,1;有核显和独显的我们选择iMac 19,1。笔记本请按照对应的cpu型号来选择。</p>
<hr>
<h3 id="2-7-1-Config–PlatformInfo–Automatic"><a href="#2-7-1-Config–PlatformInfo–Automatic" class="headerlink" title="2.7.1 Config–PlatformInfo–Automatic"></a>2.7.1 Config–PlatformInfo–Automatic</h3><p>是否自动补全系统信息。这里我选 <code>YES</code>，不重要的信息让它自动填。</p>
<hr>
<h3 id="2-7-2-Config–PlatformInfo–CustomMemory"><a href="#2-7-2-Config–PlatformInfo–CustomMemory" class="headerlink" title="2.7.2 Config–PlatformInfo–CustomMemory"></a>2.7.2 Config–PlatformInfo–CustomMemory</h3><p>自定义内存选项，请选择<code>NO</code></p>
<hr>
<h3 id="2-7-3-Config–PlatformInfo–Generic"><a href="#2-7-3-Config–PlatformInfo–Generic" class="headerlink" title="2.7.3 Config–PlatformInfo–Generic"></a>2.7.3 Config–PlatformInfo–Generic</h3><p>这里是我们需要填写的三码部分。</p>
<p>将 <code>OpenCore</code> 包下 <code>Utilities/macserial</code> 程序放到桌面，在终端下输入以下命令</p>
<pre><code class="bash">~/desktop/macserial --model iMacPro1,1 //你也可以换成你想要的机型比如iMac 19.1</code></pre>
<p>输入后你回获得一些序列号以及主板主板序列号，请自己选用一组，填写到 <code>MLB</code> 以及 <code>SystemSerialNumber</code> 后重启。</p>
<p>重启后，请再在终端下输入：</p>
<pre><code class="bash">ioreg -d2 -c IOPlatformExpertDevice | awk -F\&quot; &#39;/IOPlatformUUID/&#123;print $(NF-1)&#125;&#39;</code></pre>
<p>得到你的主板 UUID，填入 <code>Generic</code> 的 <code>SystemUUID</code> （此操作可以帮助你的 win 不丢失激活）</p>
<ul>
<li><p><strong>AdviseWindows</strong> <code>YES</code></p>
<ul>
<li>如果你的 <code>windows的efi</code> 不在 <code>showpicker</code> 的第一个，必须选择 <code>YES</code>。<ul>
<li><strong>SystemMemoryStatus</strong> <code>Auto</code></li>
</ul>
</li>
<li>一些机型本身是可以升级内存，但在关于本机选项卡中不显示内存选项时需要开启，一般选择 <code>Auto</code>。</li>
</ul>
</li>
<li><p><strong>SpoofVendor</strong> <code>YES</code></p>
<ul>
<li>是否把主板名称更改为 ACDT，一般我们选择 <code>YES</code>。</li>
</ul>
</li>
<li><p><strong>ProcessorType</strong> <code>0</code></p>
<ul>
<li>为一些es，qs或者amd的cpu在关于本机中显示核心数。</li>
</ul>
</li>
<li><p><strong>UpdateDataHub</strong> <code>YES</code></p>
<ul>
<li>更新DataHub。</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>UpdateNVRAM</strong> <code>YES</code></p>
<ul>
<li>更新NVRAM。</li>
</ul>
</li>
<li><p><strong>UpdateSMBIOS</strong> <code>YES</code></p>
<ul>
<li>更新 BIOS</li>
</ul>
</li>
<li><p><strong>UpdateSMBIOSMode</strong> <code>Create</code></p>
<ul>
<li>用新分配的 <code>EfiReservedMemoryType</code> 替换原有的表, 戴尔笔记本需要使用 <code>Custom</code> 并开启 <code>CustomSMBIOSGuid</code></li>
</ul>
</li>
</ul>
<hr>
<h2 id="2-8-Config—-UEFI"><a href="#2-8-Config—-UEFI" class="headerlink" title="2.8 Config—-UEFI"></a>2.8 Config—-UEFI</h2><hr>
<h3 id="2-8-1-Config–UEFI–APFS"><a href="#2-8-1-Config–UEFI–APFS" class="headerlink" title="2.8.1 Config–UEFI–APFS"></a>2.8.1 Config–UEFI–APFS</h3><ul>
<li><p><strong>EnableJumpstart</strong> <code>YES</code></p>
<ul>
<li>从 APFS 容器中加载内置 APFS 驱动，建议开启 <code>YES</code>。此选项仍然依据你的<code>Scanpolicy</code>来做出决定，请确保在<code>Scanpolicy</code>中放开 APFS 格式。</li>
</ul>
</li>
<li><p><strong>GlobalConnect</strong> <code>NO</code></p>
<ul>
<li>一些主板需要选择 yes 才能完全加载 APFS，比如 HP笔记本。</li>
</ul>
</li>
<li><p><strong>HideVerbose</strong> <code>YES</code></p>
<ul>
<li>是否隐藏啰嗦模式，一般我们需要看日志的时候才开启，所以我们选择隐藏，选择 <code>YES</code>。</li>
</ul>
</li>
<li><p><strong>JumpstartHotPlug</strong> <code>YES</code></p>
<ul>
<li>是否加载 APFS 格式的热插设备.</li>
</ul>
</li>
<li><p><strong>MinDate</strong> <code>0</code></p>
<ul>
<li>加载最低发行的 APFS 格式。一些旧的 APFS 可能会危害电脑，我们填 <code>0</code>。如果你想加载旧的发行日期的 APFS 格式硬盘，请填 <code>-1</code>。</li>
</ul>
</li>
<li><p><strong>MinVersion</strong> <code>0</code></p>
<ul>
<li>加载最低版本的 APFS 格式。填 <code>0</code> 代表从 <code>HIGH SIERRA</code> 开始加载。填<code> -1</code> 代表所有版本，建议填 <code>0</code>。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-8-2-Config–UEFI–Audio"><a href="#2-8-2-Config–UEFI–Audio" class="headerlink" title="2.8.2 Config–UEFI–Audio"></a>2.8.2 Config–UEFI–Audio</h3><p>此项的内容是帮助你在开机阶段驱动板载音频，此项对DP等数字音频无效。</p>
<ul>
<li><p><strong>AudioCodec</strong> <code>0</code></p>
<ul>
<li>填写音频声卡in节点。可以用 <code>PinConfigurator</code> 提取。</li>
</ul>
</li>
<li><p><strong>AudioDevice</strong> <code>0</code></p>
<ul>
<li>填写你声卡的路径。这里我们填写<a href="#2.3.1">章节2.3.1</a>中寻找到的声卡路径。这里我填了 <code>PciRoot(0x0)/Pci(0x1f,0x3)</code>，请按你自己的实际情况填写。</li>
</ul>
</li>
<li><p><strong>AudioOut</strong> <code>0</code></p>
<ul>
<li>音频声卡out节点。可以用 <code>PinConfigurator</code> 提取。</li>
</ul>
</li>
<li><p><strong>AudioSupport</strong> <code>NO</code></p>
<ul>
<li>是否开启黑苹果的开机提示音支持。</li>
</ul>
</li>
<li><p><strong>MinimumVolume</strong> <code>20</code></p>
<ul>
<li>声音音量，范围在 <code>0-100</code> 之间。</li>
</ul>
<p><strong>MinimumVolume</strong> <code>20</code></p>
<ul>
<li>按照默认设置。</li>
</ul>
</li>
</ul>
<blockquote>
<p>开启UEFI加载阶段的音频你必须下载<a target="_blank" rel="noopener" href="https://github.com/acidanthera/OcBinaryData/tree/master/Resources">Audio文件夹</a>,并把 Audio 文件夹放到 <code>ESP/EFI/OC/Resources</code> 下。另外你必须注意 <code>AppleAudio</code> 选项。</p>
</blockquote>
<hr>
<h3 id="2-8-3-Config–UEFI–ConnectDrivers"><a href="#2-8-3-Config–UEFI–ConnectDrivers" class="headerlink" title="2.8.3 Config–UEFI–ConnectDrivers"></a>2.8.3 Config–UEFI–ConnectDrivers</h3><p>是否加载补丁，我们选择 <code>YES</code>。</p>
<hr>
<h3 id="2-8-4-Config–UEFI–Drivers"><a href="#2-8-4-Config–UEFI–Drivers" class="headerlink" title="2.8.4 Config–UEFI–Drivers"></a>2.8.4 Config–UEFI–Drivers</h3><pre><code class="bash">Drivers
item0                      String
0 .................... MemoryAllocation.efi
1 .................... OpenRuntime.efi
2 .................... HFSPlus.efi
3 .................... OpenCanopy.efi</code></pre>
<h3 id="2-8-5-Config–UEFI–Input"><a href="#2-8-5-Config–UEFI–Input" class="headerlink" title="2.8.5 Config–UEFI–Input"></a>2.8.5 Config–UEFI–Input</h3><p>此选项是原生 Apple 开机热键的选项，需要配合我们之前设置的 <code>PollAppleHotKeys = yes</code> 一起用。下面的设置完全按照默认情况就行了。</p>
<blockquote>
<p>如果你是华硕的z87或者z97，你需要打开PointerSupport这个选项。</p>
</blockquote>
<hr>
<h3 id="2-8-6-Config–UEFI–Output"><a href="#2-8-6-Config–UEFI–Output" class="headerlink" title="2.8.6 Config–UEFI–Output"></a>2.8.6 Config–UEFI–Output</h3><ul>
<li><p><strong>ClearScreenOnModeSwitch</strong> <code>NO</code></p>
<ul>
<li>消除开机时从图形模式转换到文本时出现残影的问题，如果没有这个问题我们选择 <code>NO</code>。</li>
</ul>
</li>
<li><p><strong>ConsoleMode</strong> <code>MAX</code></p>
<ul>
<li>主机的输出方式，一般情况下填 <code>MAX</code>，或者留空。</li>
</ul>
</li>
<li><p><strong>DirectGopRendering</strong> <code>NO</code></p>
<ul>
<li>是否使用内置显卡直接渲染开机画面。</li>
</ul>
</li>
<li><p><strong>ForceResolution</strong> <code>NO</code></p>
<ul>
<li>Intel <code>Ironlake/Arrandale</code> 及之前的核心显卡需要开启此功能来自定义分辨率。</li>
</ul>
</li>
<li><p><strong>IgnoreTextInGraphics</strong> <code>NO</code></p>
<ul>
<li>修复在不使用 <code>-v</code> 跑马模式时候，开机日志导致的苹果 LOGO 显示不正确的问题。</li>
</ul>
</li>
<li><p><strong>ProvideConsoleGop</strong> <code>YES</code></p>
<ul>
<li>调用显卡 GOP。</li>
</ul>
</li>
<li><p><strong>ReconnectOnResChange</strong> <code>NO</code></p>
<ul>
<li>一些固件在 GOP 分辨率改变后会重新连接显示器才能输出，一般情况下选择 <code>NO</code>。</li>
</ul>
</li>
<li><p><strong>ReplaceTabWithSpace</strong> <code>NO</code></p>
<ul>
<li>一些固件在 <code>UEFI Shell</code> 下 <kbd>Tab</kbd> 功能键不生效，开启这个会用空格键代替。</li>
</ul>
</li>
<li><p><strong>Resolution</strong> <code>留空</code></p>
<ul>
<li>开机 UEFI 阶段的分辨率。比如我的显示器是 4K、16：9 的，就填写 <code>3840x2160</code>。根据情况填写或者不填。</li>
</ul>
</li>
<li><p><strong>SanitiseClearScreen</strong> <code>YES</code></p>
<ul>
<li>修复 4K 及以上显示器的输出问题。</li>
</ul>
</li>
<li><p><strong>TextRenderer</strong> <code>BuiltinGraphics</code></p>
<ul>
<li>OC 开机代码字体渲染方式</li>
</ul>
</li>
<li><p><strong>UgaPassThrough</strong> <code>NO</code></p>
<ul>
<li>通过 uga 来代替那些无法使用 gop 的主板，一般带 uefi 的主板以及显卡请选择 <code>NO</code>。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-8-7-Config–UEFI–ProtocolOverrides"><a href="#2-8-7-Config–UEFI–ProtocolOverrides" class="headerlink" title="2.8.7 Config–UEFI–ProtocolOverrides"></a>2.8.7 Config–UEFI–ProtocolOverrides</h3><ul>
<li><p><strong>AppleAudio</strong> <code>NO</code></p>
<ul>
<li>如果你想要开启如同白苹果一样的开机音效，请开启它，并且还需要配合 <code>UEFI--Audio</code> 的正确设置。</li>
</ul>
</li>
<li><p><strong>AppleBootPolicy</strong> <code>NO</code></p>
<ul>
<li>虚拟机的 Mac 需要用的。</li>
</ul>
</li>
<li><p><strong>AppleDebugLog</strong> <code>NO</code></p>
<ul>
<li>重新安装苹果错误日志界面。</li>
</ul>
</li>
<li><p><strong>AppleEvent</strong> <code>NO</code></p>
<ul>
<li>虚拟机并具有 <code>Vault</code> 的 Mac 需要用的。</li>
</ul>
</li>
<li><p><strong>AppleFramebufferInfo</strong> <code>NO</code></p>
<ul>
<li>为虚拟机使用，不是虚拟机选择 <code>NO</code>。</li>
</ul>
</li>
<li><p><strong>AppleImageConversion</strong> <code>NO</code></p>
<ul>
<li>重建 Apple 图标。</li>
</ul>
</li>
<li><p><strong>AppleImg4Verification</strong> <code>NO</code></p>
<ul>
<li>当开启安全启动时必须开启它。</li>
</ul>
</li>
<li><p><strong>AppleKeyMap</strong> <code>NO</code></p>
<ul>
<li>重建苹果功能键。</li>
</ul>
</li>
<li><p><strong>AppleRtcRam</strong> <code>NO</code></p>
<ul>
<li>重装 <code>AppleRtc</code> 协议。</li>
</ul>
</li>
<li><p><strong>AppleSecureBoot</strong> <code>NO</code></p>
<ul>
<li>苹果安全启动协议。</li>
</ul>
</li>
<li><p><strong>AppleSmcIo</strong> <code>NO</code></p>
<ul>
<li>代替之前的 <code>VirtualSMC.efi</code>，在使用<code>vault</code>功能时需要开启。</li>
</ul>
</li>
<li><p><strong>AppleUserInterfaceTheme</strong> <code>NO</code></p>
<ul>
<li>重新安装 <code>Apple User Interface Theme</code> 协议。</li>
</ul>
</li>
<li><p><strong>DataHub</strong> <code>NO</code></p>
<ul>
<li>重建 <code>Datahub</code>。</li>
</ul>
</li>
<li><p><strong>DeviceProperties</strong> <code>NO</code></p>
<ul>
<li>虚拟机或者老款的电脑需要选择 <code>YES</code> 才能注入 <code>Device Property</code>，我们选NO。如果你发现你注入 <code>Device Property</code> 无效，请选择 <code>YES</code>。</li>
</ul>
</li>
<li><p><strong>FirmwareVolume</strong> <code>NO</code></p>
<ul>
<li>Vault/虚拟机/老款 Mac 需要开启才能相关项。</li>
</ul>
</li>
<li><p><strong>HashServices</strong> <code>NO</code></p>
<ul>
<li>Vault 相关项。</li>
</ul>
</li>
<li><p><strong>OSInfo</strong> <code>NO</code></p>
<ul>
<li>通知主板以及一些程序关于 Mac 引导的信息，一般情况选择 <code>NO</code>。</li>
</ul>
</li>
<li><p><strong>UnicodeCollation</strong> <code>NO</code></p>
<ul>
<li>旧的主板需要，我们选 <code>NO</code>。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-8-8-Config–UEFI–Quirks"><a href="#2-8-8-Config–UEFI–Quirks" class="headerlink" title="2.8.8 Config–UEFI–Quirks"></a>2.8.8 Config–UEFI–Quirks</h3><ul>
<li><p><strong>DeduplicateBootOrder</strong> <code>YES</code></p>
<ul>
<li>当 <code>RequestBootVarRouting</code> 选项为开启时，一些其他的操作系统（e.g.windows)可能在某些主板(e.g.ASUS)中会找不到自己的引导而重新创建,最终导致黑果在没有清理 <code>NVRAM</code> 的情况下是无法进入系统,或者产生多个 <code>OpenCore</code> 引导项，请选择 <code>YES</code>。</li>
</ul>
</li>
<li><p><strong>ExitBootServicesDelay</strong> <code>0</code></p>
<ul>
<li>旧主板需要给予主板退出时间（单位为微秒），较新的主板直接填 <code>0</code>。旧的主板比如 Z87pro，填 <code>3000000-5000000</code>。</li>
</ul>
</li>
<li><p><strong>IgnoreInvalidFlexRatio</strong> <code>NO</code></p>
<ul>
<li>如果你没有在 BIOS 中解锁 <code>MSR0x194</code>，一定要选YES。</li>
</ul>
</li>
<li><p><strong>ReleaseUsbOwnership</strong> <code>NO</code></p>
<ul>
<li>大部分的主板都有自动释放 USB 所有权的功能，我们选 <code>NO</code>。如果你开机键盘鼠标卡死了，或者 USB 失灵，试试选 <code>YES</code>。</li>
</ul>
</li>
<li><p><strong>RequestBootVarRouting</strong> <code>YES</code></p>
<ul>
<li>增加 <code>启动磁盘</code> 的可靠性。</li>
</ul>
</li>
<li><p><strong>TscSyncTimeout</strong> <code>0</code></p>
<ul>
<li>帮助一些 X99、X299 的主板开启全核同步功能。此选项旨在代替 <code>TSCAdjustReset.kext</code> 等类似补丁，推荐的值是 <code>500000</code>。但是此选项并不能在睡眠唤醒后生效，所以请填写默认值 <code>0</code>，并使用 <code>TSCAdjustReset.kext</code> 来做全核同步。</li>
</ul>
</li>
<li><p><strong>UnblockFsConnect</strong> <code>NO</code></p>
<ul>
<li>惠普笔记本可能会让 OC 无法扫描到启动项，一般选择NO，如果你是惠普笔记本，请选择YES。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-8-9-Config—-UEFI—-ReservedMemory-Properties"><a href="#2-8-9-Config—-UEFI—-ReservedMemory-Properties" class="headerlink" title="2.8.9 Config—-UEFI—-ReservedMemory Properties"></a>2.8.9 Config—-UEFI—-ReservedMemory Properties</h3><p>此项为保留内存所用。一些硬件会把硬件 EFI 写进内存过程中占据必要的 UEFI 运行空间，所以我们可以通过此项来预留内存来保证 UEFI 的运行。填写方式可以参考<a target="_blank" rel="noopener" href="https://blog.daliansky.net/Slide-value-acquisition-and-calculation.html">小兵的文章</a>。来寻找指定内存的起始位置，以 4K 为一个节点。一般情况下，此项我们并不需要理会。</p>
<hr>
<h2 id="3-0-OpenCore-完善"><a href="#3-0-OpenCore-完善" class="headerlink" title="3.0 OpenCore 完善"></a>3.0 OpenCore 完善</h2><h3 id="3-1-模拟NVRAM"><a href="#3-1-模拟NVRAM" class="headerlink" title="3.1 模拟NVRAM "></a>3.1 模拟NVRAM <a id=3.1></a></h3><p>对 OC 而言，<code>NVRAM</code> 是非常核心的一环，不管是原生还是模拟的。<span style="color:red;">如果你是原生nvram的主板，请不必理会这章节</span>。</p>
<p>这章节的主要内容为非原生 NVRAM 模拟生成 <code>nvram.plist</code>。</p>
<ul>
<li><p>首先打开我们之前下载好的 OpenCore，进入目录下的 <code>Utilities/LogoutHook</code> 文件夹，你会看到 <code>LogoutHook.command</code> 文件。</p>
</li>
<li><p>打开 Terminal（终端）并输入 <code>cd ~</code> 返回到用户根目录，输入 <code>mv</code> 和一个空格，然后鼠标拖动 <code>LogoutHook.command</code> 文件到 Terminal（终端），再在终端输入 <code>~/.LogoutHook.command</code></p>
</li>
</ul>
<pre><code class="bash">例如（不要直接复制这条命令行）
 mv /Users/xjn/Downloads/OpenCore-0.6.2-RELEASE/Utilities/LogoutHook/LogoutHook.command ~/.LogoutHook.command</code></pre>
<ul>
<li>最后在 Terminal（终端）中，输入以下命令按回车：</li>
</ul>
<pre><code class="bash">sudo defaults write com.apple.loginwindow LogoutHook /Users/$USER/.LogoutHook.command</code></pre>
<ul>
<li><p>终端会提示要求你输入密码（密码打进去不会显示）。</p>
</li>
<li><p>重启，你会在 <code>ESP/EFI/</code> 下看到 <code>nvram.plist</code>，代表已经成功模拟了。</p>
</li>
</ul>
<hr>
<h3 id="3-2-建立自己的开机选择系统目录"><a href="#3-2-建立自己的开机选择系统目录" class="headerlink" title="3.2 建立自己的开机选择系统目录"></a>3.2 建立自己的开机选择系统目录</h3><details>
  <summary><font color=red>因此部分需求太小众且繁琐，我折叠起来了，点击展开</font></summary>

<p>这个教程主要针对的是非原生 <code>nvram</code> 主板的用户，<span style="color:red;">如果你是原生 <code>nvram</code> 的用户，直接在偏好设置—启动磁盘中选定你希望设置为默认启动的磁盘即可，不必往下看浪费时间！</span></p>
<p>此步骤可能只适合 OC 纯净安装的系统，如果你之前使用过 clover 或者 oc mod 版本，请参照《精解opencore》中模拟 nvram 的方法。</p>
<p>非原生 nvram 用户必须完成以下几点：</p>
<ul>
<li><p>通过 <a href="#3.1">3.1的教程</a> 建立 <code>nvram.plist</code>.</p>
</li>
<li><p>确保 OpenCore 的版本为 2019年11月20日 之后的。更新 OpenCore 替换 <code>BOOT/BOOTx64.efi</code> 以及 <code>OC/OpenCore.efi</code> 即可。</p>
</li>
<li><p>确保 <code>config.plist</code> 下 <code>/Misc/Security/</code> 的 <code>ExposeSensitiveData=3</code> ;  <code>Booter/Quirks/</code> 的 <code>DisableVariableWrite=YES</code> ; <code>NVRAM/LegacyEnable</code>= <code>YES</code></p>
</li>
<li><p>确保文件夹 <code>ESP/EFI/OC/Drivers/</code> 下没有 <code>VariableRuntimeDxe.efi</code></p>
</li>
</ul>
<p>如果你是华硕的非原生nvram主板，你还需要做（此文件由群友 @哞 提供）：</p>
<ul>
<li>下载<a href="#3.1">LoginHook.command</a>，把它与 <code>LogoutHook.command</code> 放在一起，并执行:</li>
</ul>
<pre><code class="bash">sudo defaults write com.apple.loginwindow LoginHook ~/.LoginHook.command</code></pre>
<blockquote>
<p>3.2.1 以及 3.2.2 也是排列启动盘开机进入顺序的，比较麻烦，不推荐。</p>
</blockquote>
<hr>
<h4 id="3-2-1-第一部分"><a href="#3-2-1-第一部分" class="headerlink" title="3.2.1 第一部分"></a>3.2.1 第一部分</h4><p>我们首先要对 <code>Config--Misc--Security--scanpolicy</code> 这个值进行修改，默认的是 0，代表着扫描所有硬盘，而我们现在只让它扫我们的苹果系统硬盘。</p>
<p>感谢 @xlivans 提供的 OC 扫描策略：</p>
<blockquote>
<p>  - <code>2F0303</code> —官方推荐值+允许扫描HFS文件系统+允许扫描USB设备</p>
</blockquote>
<blockquote>
<p>    最终<code>扫描策略数值</code> = <code>3080963</code></p>
</blockquote>
<blockquote>
<p>OC-引导扫描策略</p>
</blockquote>
<blockquote>
<ul>
<li>设置位置：<code>Misc\Security\ScanPolicy</code></li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><strong>定义：</strong></li>
</ul>
</blockquote>
<blockquote>
<p>  （01）0x00000001 — 限定为文件系统，由以下<code>允许扫描文件系统子项</code>开启</p>
</blockquote>
<blockquote>
<p>  （02）0x00000002 — 限定为设备类型，由以下<code>允许扫描设备类型子项</code>开启</p>
</blockquote>
<blockquote>
<p>  <code>允许扫描文件系统子项</code>：</p>
</blockquote>
<blockquote>
<p>  （03）0x00000100 — 允许扫描APFS文件系统</p>
</blockquote>
<blockquote>
<p>  （04）0x00000200 — 允许扫描HFS文件系统</p>
</blockquote>
<blockquote>
<p>  （05）0x00000400 — 允许扫描EFI系统分区文件系统</p>
</blockquote>
<blockquote>
<p>  <code>允许扫描设备类型子项</code>：</p>
</blockquote>
<blockquote>
<p>  （06）0x00010000 — 允许扫描SATA设备</p>
</blockquote>
<blockquote>
<p>  （07）0x00020000 — 允许扫描SAS和Mac NVMe设备</p>
</blockquote>
<blockquote>
<p>  （08）0x00040000 — 允许扫描SCSI设备</p>
</blockquote>
<blockquote>
<p>  （09）0x00080000 — 允许扫描NVMe设备</p>
</blockquote>
<blockquote>
<p>  （10）0x00100000 — 允许扫描CD / DVD设备</p>
</blockquote>
<blockquote>
<p>  （11）0x00200000 — 允许扫描USB设备</p>
</blockquote>
<blockquote>
<p>  （12）0x00400000 — 允许扫描FireWire设备</p>
</blockquote>
<blockquote>
<p>  （13）0x00800000 — 允许扫描读卡器设备</p>
</blockquote>
<blockquote>
<p>  <code>扫描策略数值</code>=（01）+（02）+1个或数个<code>允许扫描文件系统子项</code>+1个或数个<code>允许扫描设备类型子项</code></p>
</blockquote>
<blockquote>
<p>  例如：希望扫描对象是APFS文件系统的USB设备，<code>扫描策略数值</code>=（01）+（02）+（03）+（11），经16进制加法计算得出，<code>扫描策略数值</code>=<code>0x200103</code>。</p>
</blockquote>
<blockquote>
<p>  <code>注意</code>，使用时需将16进制转换为10进制。示例最终<code>扫描策略数值</code>=<code>2097411</code></p>
</blockquote>
<blockquote>
<ul>
<li>几种扫描策略</li>
</ul>
</blockquote>
<blockquote>
<p>  - <code>F0103</code> —官方推荐值：（01）+（02）+（03）+（06）+（07）+（08）+（09）</p>
</blockquote>
<blockquote>
<p>    最终<code>扫描策略数值</code> = <code>983299</code></p>
</blockquote>
<blockquote>
<p>  - <code>0</code>—允许扫描所有已知文件系统+允许扫描所有已知设备类型。</p>
</blockquote>
<blockquote>
<p>  - <code>2F0303</code> —官方推荐值+允许扫描HFS文件系统+允许扫描USB设备</p>
</blockquote>
<blockquote>
<p>    最终<code>扫描策略数值</code> = <code>3080963</code></p>
</blockquote>
<p>我们这里让 OC 只扫描 MAC 盘。根据说明，（1）+（2）是必须选的；因为我的 MAC 是 APFS，所以系统子项类我选（3）；我的 MAC 是安装在 NVME 上的，所以我在设备类型上选择（09），如果你是安装在 SATA 盘上的，你应该选（6）。</p>
<p>这样我们的公式就是：</p>
<pre><code class="bash">（1）+（2）+（3）+（9）= 0x00000001+0x00000002+0x00000100+0x00080000</code></pre>
<p>拿起苹果自带的计算器，按住<code>command+3</code>切换到编程型计算器，并转换到16进制模式:</p>
<pre><code class="bash">1+2+100+80000=80103</code></pre>
<p>得到数值后，我们再按一下转换10进制的按键，得出 <code>524547</code> 这个数值。</p>
<p>我们把 <code>524547</code> 填到 <code>scanpolicy</code> 中，重启，你就会看到第一个选项就是你的MAC盘了。但如果你还安装了WINDOWS什么的，选项中却没有了，别急，我们现在要把WIN的引导添加到mac的后面去。</p>
<hr>
<h4 id="3-2-2-第二部分"><a href="#3-2-2-第二部分" class="headerlink" title="3.2.2 第二部分"></a>3.2.2 第二部分</h4><p>现在我们要在开机画面中，将其他的一些系统排在mac后面。此项需要你下载debug版本的Opencore,请在文章开始部分提到的Opencore程序下载界面进行下载，并备份好你目前的EFI。</p>
<p>首先我们需要把下载好的 Opencore-Debug 版本里的 <code>ESP/EFI/BOOT/BOOTx64.efi</code> 以及 <code>ESP/EFI/OpenCore.efi</code> 两个文件替换到你正在使用中的 EFI 里去。修改你正在使用的 <code>EFI/OC/Config.plist</code>:</p>
<pre><code class="xml">Misc
    Debug
       DisableWatchDog    Boolean    YES
       Target             Number     65

     Security
       ScanPolicy         Number     0 //这里我们要先改为0来寻找windows的地址，之后找到后改回之前算出来的即可</code></pre>
<p>接着，我们需要寻找你其他系统的UUID，我们打开终端，输入</p>
<pre><code class="bash">diskutil list</code></pre>
<p>找到你需要的盘的盘名，比如我的windows在disk0这个位置，而引导WIN的EFI文件夹的盘位是disk0s1。注意，Windows必须为<code>GPT引导模式</code>。</p>
<pre><code class="bash">/dev/disk1 (internal, physical):
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:      GUID_partition_scheme                        *1.0 TB     disk0
   1:                        EFI                         314.6 MB   disk0s1
   2:       Microsoft Basic Data BOOTCAMP                999.7 GB   disk0s2</code></pre>
<p>接着输入：</p>
<pre><code class="bash">diskutil info disk0s1</code></pre>
<p>在输出内容里，我们需要的是 <code>Disk / Partition UUID</code>，我的是 <code>FF555974-AB3F-40B7-8530-AE6462E197CE</code>，把它记下来。</p>
<p>现在我们通过oc的开机选项直接重启到windows，我们打开<a target="_blank" rel="noopener" href="https://www.diskgenius.cn/download.php">DiskGenius</a>，并且到我们mac的EFI盘符下，我们看到有一个日志报告 <code>opencore-xxxxx-xxxxx</code> 生成，为了好记，我们右键把它改名叫 <code>111.txt</code>，并拖到桌面。</p>
<p>打开刚才的 <code>111.txt</code>，我们搜索刚才记录下来的 <code>FF555974-AB3F-40B7-8530-AE6462E197CE</code></p>
<p>搜到类似这样的路径就是我们需要的：</p>
<pre><code class="bash">PciRoot(0x0)/Pci(0x1B,0x0)/Pci(0x0,0x0)/NVMe(0x1,CB-27-B3-91-53-38-25-00)/HD(1,GPT,FF555974-AB3F-40B7-8530-AE6462E197CE,0x800,0x96000)/\EFI\BOOT\BOOTX64.EFI</code></pre>
<p>把之前我们备份好的EFI，全部替换回去。把 <code>disablewatchdog</code>，<code>target</code>，<code>scanpolicy</code> 都改回原来的。这样我们的EFI又回到正式版本了，而不是 DEBUG 版本了。</p>
<p>回到Mac，打开 <code>config.plist</code>，我们把 win 的引导路径添加到 <code> misc--entries</code>，并在此下面添加一个 item,输入如图内容：</p>
<pre><code class="xml">Entries
   Arguments     String    
   Comment       String     Windows 10//你随便取个名字
   Enabled       Boolean    YES
   Name          String     Windows 10/开机选择界面的名字
   Path          String     PciRoot(0x0)/Pci(0x1B,0x0)/Pci(0x0,0x0)/NVMe(0x1,CB-27-B3-91-53-38-25-00)/HD(1,GPT,FF555974-AB3F-40B7-8530-AE6462E197CE,0x800,0x96000)/\EFI\BOOT\BOOTX64.EFI</code></pre>
<p>保存重启后，你会看到windows10放在了mac的下面。</p>
<blockquote>
<p>tips: 你可以<code>showpicker</code>选择no，就不会看到选择界面了，而当你需要时，只需要在开机时候按住option或者esc就可以唤出选择界面了，非常白果的体验哦。</p>
</blockquote>
</details>

<hr>
<h3 id="3-3-提取DSDT"><a href="#3-3-提取DSDT" class="headerlink" title="3.3 提取DSDT"></a>3.3 提取DSDT</h3><p>尽管提取原始DSDT的方法非常多，我认为 <code>CLOVER</code> 的提取方法是最方便并且靠谱的。我们需要一个空的U盘或者空的ESP分区，我的教程是非常偏向小白的，所以这里提取我也会用到windows，以及Diskgenius这个软件，做最简单的示范。</p>
<ul>
<li><p>进入Windows，插入U盘，打开<a target="_blank" rel="noopener" href="https://www.diskgenius.cn/download.php">DiskGenius</a>，选中我们的U盘，并选择顶部菜单栏的快速分区</p>
<ul>
<li>分区表类型：<code>GUID</code></li>
<li>不要创建新的 <code>ESP</code> 分区</li>
<li>不要创建新的 <code>MSR</code> 分区</li>
<li>分区格式为 <code>FAT32</code></li>
</ul>
</li>
<li><p>格式化完成后，放入我从黑果小兵镜像包提取出来的<a href="/tools/EFI.zip">EFI</a>放进去。这是一个 clover 引导，但并不能引导你的系统，只能提取 DSDT。</p>
</li>
<li><p>插上U盘，重启，通过U盘引导，看到Clover界面，我们按F4，这样原始的DSDT文件就收集好了。</p>
</li>
<li><p>重新通过OC引导进入系统，我们打开U盘，EFI/Clover/ACPI/Orgin下，有我们的原始ACPI内容，我们只需要DSDT.aml这个就行了，保存到安全的地方。</p>
</li>
</ul>
<hr>
<h3 id="3-4-加载原生电源管理"><a href="#3-4-加载原生电源管理" class="headerlink" title="3.4 加载原生电源管理"></a>3.4 加载原生电源管理</h3><p>提取 DSDT 后使用 <code>MaciASL</code> 打开，搜索你 CPU 的名字。一般情况下，CPU 的名字可能是: <code>PR.CPU0</code>,<code>PR.P000</code>,<code>PR.PR00</code>,<code>SB.CPU0</code>,<code>SB.P000</code>,<code>SB.PR00</code>, <code>SCK0.C000</code>, <code>SCK0.CPU0</code>。请依次搜索直到找到自己的CPU名字，比如我的就是<code>SCK0.C000</code></p>
<pre><code class="asl">Processor (C000, 0x00, 0x00001810, 0x06)
                &#123;
                    Name (_HID, &quot;ACPI0007&quot; /* Processor Device */)  // _HID: Hardware ID
                    Name (_UID, &quot;SCK0-C000&quot;)  // _UID: Unique ID
                    Method (_PXM, 0, NotSerialized)  // _PXM: Device Proximity
                    &#123;
                        If ((CLOD == 0x00))
                        &#123;
                            Return (0x00)
                        &#125;
                        Else
                        &#123;
                            Local0 = DerefOf (APT0 [0x00])
                            Local1 = CNBS /* \CNBS */
                            Local1 -= 0x01
                            Local0 &gt;&gt;= Local1
                            Local0 &amp;= 0x01
                            Local1 = 0x00
                            Local1 *= 0x02
                            If ((Local0 == 0x01))
                            &#123;
                                Local1 += 0x01
                            &#125;

                            Return (Local1)
                        &#125;
                    &#125;</code></pre>
<p>打开宪武大大的<a target="_blank" rel="noopener" href="https://github.com/daliansky/OC-little">OC Little</a>，到 <code>05-注入设备/05-1-注入x86/</code> 目录下，我们看到宪武大大已经把大部分不同名字的CPU的 dsl 文件都做好了。我的 CPU 名字叫 <code>SCK0.C000</code>，打开 <code>SSDT-PLUG-_SCK0.C000.dsl</code>，左上角另存为（save as), 其中文件格式(file format)必须选择 <code>ACPI Machine Language Binary</code>，文件名字随便写吧，我就叫 <code>plug-xcpm.aml</code>，记住后缀为 <code>.aml</code>。</p>
<p>将 <code>plug-xcpm.aml</code> 放入 <code>EFI/OC/ACPI</code> 下，并在 <code>config.plist</code> 中添加加载此 aml 文件:</p>
<pre><code class="xml">ACPI
  Add
    Item 0
      Comment    String       plug-xcpm
      Enable     Boolean      YES
      Path       String       plug-xcpm.aml</code></pre>
<p>加载后，重启，并清理一次 <code>nvram</code>，我们看到偏好设置–节能中，原生电源管理已经被加载了。</p>
<hr>
<h4 id="3-4-1-节能五项"><a href="#3-4-1-节能五项" class="headerlink" title="3.4.1 节能五项"></a>3.4.1 节能五项</h4><p>节能五项是白果台式机中，<code>系统偏好设置</code>—<code>节能</code> 中的五个选项。在加载原生电源管理后，一般有4项节能出现，而第五项“断电后重启”这项还需要加载 <code>PPMC</code> 以及 <code>LPCB</code> 下的 <code>PMCR</code> 才能出现。虽然没啥鸟用，但对于强迫者而言，少一个一定很难受吧。如果你是笔记本，不需要看这章，白果笔记本本身没有。如果你没有机械硬盘，也不会出现 <code>Put hard disks to sleep when possible</code>。</p>
<p>直接下载<a href="/tools/SSDT-PM.zip">SSDT-PM.aml</a>载入即可。</p>
<hr>
<h3 id="3-5-解锁-macOS-的系统目录"><a href="#3-5-解锁-macOS-的系统目录" class="headerlink" title="3.5 解锁 macOS 的系统目录"></a>3.5 解锁 macOS 的系统目录</h3><p>bugprogrammer给出了一个一劳永逸的解决方案：</p>
<p><a target="_blank" rel="noopener" href="http://www.bugprogrammer.me/2019/07/13/unlockSystem.html">解锁macOS10.15的系统分区</a></p>
<p>11系统的解锁略麻烦：<a target="_blank" rel="noopener" href="https://www.bugprogrammer.me/2020/07/09/about-BigSur.html#%E5%88%A0%E9%99%A4%E5%BF%AB%E7%85%A7%EF%BC%8C%E9%87%8D%E8%8E%B7%E6%9D%83%E9%99%90">解锁MacOS11的系统区</a></p>
<hr>
<h3 id="3-6-关于EC控制器"><a href="#3-6-关于EC控制器" class="headerlink" title="3.6 关于EC控制器"></a>3.6 关于EC控制器</h3><p>EC控制器是电脑自带的一个叫 <code>embedded controller</code> 的部件。在 10.15 的系统环境中，笔记本电脑必须重命名原来的 EC，而一些台式机主板则需要禁用。下面我会分开来讲解如何禁用 EC、如何加载 USB 电源管理支持。</p>
<hr>
<h4 id="3-6-1-禁用EC控制器"><a href="#3-6-1-禁用EC控制器" class="headerlink" title="3.6.1 禁用EC控制器"></a>3.6.1 禁用EC控制器</h4><p><a href="#2.1.3">之前的章节</a>中提供了重命名这种方式去讲 EC0 更名为 EC，其实这种方法是只适合笔记本的，台式机最好还是禁用 EC。</p>
<p>打开之前提取出来的 DSDT.aml，搜索 <code>PNP0C09</code>，这里我搜到我的EC真实名字叫做 <code>H_EC</code>，你的可能叫 <code>EC0</code> 或者别的什么奇怪的名字。</p>
<p>这里我可以看到我的 <code>H_EC</code> 已经是屏蔽掉的，怎么判定，你看下面有一个 <code>Return (Zero)</code>，意味着这个部件是不生效的，即禁用。这样的情况我们不需要做任何 SSDT 去禁用这个真的 EC。</p>
<pre><code class="asl">    Scope (_SB.PCI0.LPCB)
    &#123;
        Device (H_EC)
        &#123;
            Name (_HID, EisaId (&quot;PNP0C09&quot;) /* Embedded Controller Device */)  // _HID: Hardware ID
            Name (_UID, One)  // _UID: Unique ID
            Method (_STA, 0, NotSerialized)  // _STA: Status
            &#123;
                ^^^GFX0.CLID = 0x03
                Return (Zero)
            &#125;</code></pre>
<p>那么什么样的情况是需要我们去屏蔽的呢？我发现基本上华硕的台式机主板都会启用这个EC控制器，下面代码是华硕主板的EC部件，搜索 <code>PNP0C09</code>，我们看到这种情况下，这个叫 EC0 的 <code>EC</code> 控制器是开启的，注意他没有 <code>return (Zero)</code> 这个语句，我们需要通过 SSDT 去屏蔽它。</p>
<pre><code class="asl">        Device (EC0)
        &#123;
            Name (_HID, EisaId (&quot;PNP0C09&quot;) /* Embedded Controller Device */)  // _HID: Hardware ID
            Name (_CRS, ResourceTemplate ()  // _CRS: Current Resource Settings
            &#123;
                IO (Decode16,
                    0x0062,             // Range Minimum
                    0x0062,             // Range Maximum
                    0x00,               // Alignment
                    0x01,               // Length
                    )
                IO (Decode16,
                    0x0066,             // Range Minimum
                    0x0066,             // Range Maximum
                    0x00,               // Alignment
                    0x01,               // Length
                    )
            &#125;)</code></pre>
<p>这里我提供了一个禁用 EC 的补丁，请直接下载，打开后左上角另存为（save as), 其中文件格式(file format)必须选择 <code>ACPI Machine Language Binary</code>，文件名字随便写吧，我就叫 <code>ssdt-no-EC.aml</code>，记住后缀为 <code>.aml</code>。将 <code>ssdt-no-EC.aml</code> 放入 <code>EFI/OC/ACPI</code> 目录下，并在 <code>config.plist</code> 中加载此 aml 文件。</p>
<p>直接下载<a href="/tools/SSDT-no-EC.dsl.zip">SSDT-PM.aml</a>载入即可。</p>
<p>如果你的 EC 名字叫 H_EC 或者别的什么的，你打开这个 <code>.dsl</code> 文件，替换代码中所有的 EC0 为 H_EC。</p>
<pre><code class="asl">&#123;
    External (_SB.PCI0.LPCB, DeviceObj)
    External (_SB_.PCI0.LPCB.H_EC, DeviceObj)

    Scope (\_SB.PCI0.LPCB.H_EC)
    &#123;
        Method (_STA, 0, NotSerialized)  // _STA: Status
        &#123;
            If (_OSI (&quot;Darwin&quot;))
            &#123;
                Return (0)
            &#125;
            Else
            &#123;
                Return (0x0F)
            &#125;
        &#125;
    &#125;
 &#125;</code></pre>
<blockquote>
<p>当你的电脑没有EC后，你仍然需要仿冒EC来完成全部操作。</p>
</blockquote>
<hr>
<h4 id="3-6-2-重命名EC控制器"><a href="#3-6-2-重命名EC控制器" class="headerlink" title="3.6.2 重命名EC控制器"></a>3.6.2 重命名EC控制器</h4><p>笔记本不能禁用 EC，禁用 EC 后会直接导致笔记本没有电池。那么我们怎么去重命名 EC 呢？按照上面提到的方法，找到你 EC 的真实名字，在<a href="#2.1.3">之前的章节</a>中我提供了假如你的笔记本的 EC 叫做 <code>EC0</code> 时候的重命名办法，那如果你的 E C叫别的乱七八糟的名字呢？</p>
<p>EC 名，比如你的 EC 叫做 <code>H_EC</code>，我们打开在线的<a target="_blank" rel="noopener" href="https://tool.lu/hexstr/">HEX转换器</a>，输入 <code>H_EC</code>，并点击下面的16进制转换，就可以看到转换出来的值是 <code>485F4543</code>，把这个值替换到 <code>Find</code> 这个选项卡中就行了。你也会注意到，EC 的  hex-16 进制为 <code>45435F5F</code>，刚好是 <code>Replace</code> 的值。这就是一个非常简单实用的 OC 重命名。切记！OC 万不得已不要用重命名！</p>
<pre><code class="xml">Comment:                H_EC to EC
Count:                    0
Enabled:                YES
Find:                    &lt;485F4543&gt;
Limit:                    0
Mask:                    &lt;&gt;
OemTable:                &lt;&gt;
Replace:                &lt;45435F5F&gt;
ReplaceMask:            &lt;&gt;
Skip:                    0
TableLength:            0
TableSignature:            &lt;&gt;</code></pre>
<hr>
<h4 id="3-6-3-仿冒EC及USBX供电"><a href="#3-6-3-仿冒EC及USBX供电" class="headerlink" title="3.6.3 仿冒EC及USBX供电"></a>3.6.3 仿冒EC及USBX供电</h4><p>禁用EC后你需要创建仿冒EC来进入系统，同时开启USB的快速供电技术（需设备支持）。你可以比较下面两张图，第二张是功能正确开启的。<br><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://i.loli.net/2020/10/31/qonmCcpUJyrk84g.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="Screen Shot 2020-10-31 at 3.40.07 PM.png"></p>

<p>这部分内容是仿冒 EC，注意不是每一个DSDT的路径都在 <code>SB.PCI0.LPCB</code>，请搜索 <code>0x001F0000</code> 来确定实际位置和名称。比如我的主板是在 <code>SB.PC00.LPC0</code>。</p>
<pre><code class="asl">    Scope (\_SB.PCI0.LPCB)
    &#123;
        Device (EC)
        &#123;
            Name (_HID, &quot;ACID0001&quot;)  // _HID: Hardware ID
            Method (_STA, 0, NotSerialized)  // _STA: Status
            &#123;
                If (_OSI (&quot;Darwin&quot;))
                &#123;
                    Return (0x0F)
                &#125;
                Else
                &#123;
                    Return (Zero)
                &#125;
            &#125;
        &#125;
    &#125;</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://i.loli.net/2020/10/31/vhNd2tGwArqlZuk.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="Screenshot-2020-02-05-at-10.47.54-AM.png"></p>

<hr>
<h3 id="3-7-睡眠即醒的相关问题"><a href="#3-7-睡眠即醒的相关问题" class="headerlink" title="3.7 睡眠即醒的相关问题"></a>3.7 睡眠即醒的相关问题</h3><p>睡眠即醒很大程度上跟 USB 的定制相关，一般一个好的 USB 定制就能解决睡眠即醒的问题。当然还有很多无法解决的问题，比如蓝牙不能在 HUB 下进行内建，等等。甚至有些时候我们都不知道为什么黑果会睡不着，那有没有一个办法让黑果强制睡眠呢？答案是有的。经过我的摸索，有几种方法能达到强制睡眠的效果，只是方法不同而已，但主要围绕的还是 <code>0d/6d</code> 的数值来做一些工作。这些方法涉及了很多 OC 领域的一些小技巧，我也顺便展示给大家。</p>
<blockquote>
<p><code>0d/6d</code> 补丁是阻止一些部件参与唤醒工作，这其中包括了xhc部件，意味着你无法使用鼠标键盘唤醒，只能用电源键唤醒。但若你有一组除了xhc之外的usb控制器，那把键盘鼠标插在那两个控制器上，可以在使用强制睡眠的情况下用键盘鼠标唤醒电脑。</p>
</blockquote>
<hr>
<h4 id="3-7-1-分辨0D-06"><a href="#3-7-1-分辨0D-06" class="headerlink" title="3.7.1 分辨0D/06"></a>3.7.1 分辨0D/06</h4><p>主板一般有5个部件是直接参与唤醒工作的，这五个部件分别是 XHC（USB控制器）、CNVW（CNVI网卡，如果你的主板自带的话）、GLAN（有线网卡）、XDCI（USB相关）、HDEF（音频）。旧的一些主板可能会有不同的命名，比如 XHC 有叫 EH01，HDEF 叫做 HDAS 等，这里不做讨论。而这些设备往往会直接影响睡眠，比如你输入：</p>
<pre><code class="bash">log show --last 1d | grep &quot;Wake reason&quot;</code></pre>
<p>我们会看到类似的输出结果</p>
<pre><code class="bash">2020-10-31 03:35:45.196371+0800 0x74       Default     0x0                  0      0    kernel: (AppleACPIPlatform) AppleACPIPlatformPower Wake reason: XDCI CNVW
2020-10-31 03:35:45.196373+0800 0x74       Default     0x0                  0      0    kernel: (AppleACPIPlatform) AppleACPIPlatformPower Wake reason: XDCI CNVW</code></pre>
<p>那么即 是<code>XDCI</code> <code>CNVW</code> 导致了睡眠出现了问题。于是，我们用几种方法去屏蔽或者说修改这些部件，来达到电脑正常睡眠的效果。</p>
<p>我们打开之前提取的SSDT，随便搜索五大部件中的一个，比如说 XDCI：<br><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://i.loli.net/2020/10/31/k5jDCx9c3WdJunh.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="截屏2019-11-07下午11.06.02.png"></p>

<p>主要是看上图中 <code>XDCI</code> 下的 <code>_PRW</code> 属性值，可以直接看到 Return 的值为 <code>GPRW (0x6D, 0x04)</code>。其中 <code>6D</code> 这个数值看主板而定，有些主板叫做 <code>0D</code>，而后面 <code>04</code> 这个值的含义为 S4 级别的电源管理，即休眠甚至关机情况下的唤醒；有些后面的数值是 <code>03</code>，代表着 S3 级电源管理。这个我打一个大家比较熟悉的例子， <code>GLAN</code> 这个网卡部件的 <code>PRW</code> 值也是 <code>0x04</code>，为什么要是 <code>04</code> 呢？因为这样我们可以使用远程通过网络启动主机功能。</p>
<h4 id="3-7-1-1-方法一-OC-全局重命名强制睡眠"><a href="#3-7-1-1-方法一-OC-全局重命名强制睡眠" class="headerlink" title="3.7.1.1 方法一: OC 全局重命名强制睡眠"></a>3.7.1.1 方法一: OC 全局重命名强制睡眠</h4><p>上一步中已经确认了你的主板是 <code>0D</code> 还是 <code>06</code>，打开 <code>OC little</code> 的 <code>06/0D</code> 补丁，选择合适自己主板的补丁集，比如我的是 <code>Name-6D更名.plist</code>。将补丁抄入自己的 <code>config.plist</code> 后重启生效。</p>
<blockquote>
<p>全局重命名会导致其他系统无法通过 OC 引导开机，不建议使用。</p>
</blockquote>
<hr>
<h4 id="3-7-1-2-方法二-沿用Clover版本的0D-06补丁-amp-展示TgtBridge在OC下的用法"><a href="#3-7-1-2-方法二-沿用Clover版本的0D-06补丁-amp-展示TgtBridge在OC下的用法" class="headerlink" title="3.7.1.2 方法二: 沿用Clover版本的0D/06补丁&amp;展示TgtBridge在OC下的用法"></a>3.7.1.2 方法二: 沿用Clover版本的0D/06补丁&amp;展示TgtBridge在OC下的用法</h4><p>宪武大大做的 clover 版本的 0d/6d 补丁，其实没啥必要讲，只是有留言问了 tgtbridge 在 oc 下怎么用，那我就展示一下吧。这个补丁原理是一样的，通过重命名的方式改 <code>_prw</code>。</p>
<p>直接下载宪武大大的<a target="_blank" rel="noopener" href="https://github.com/daliansky/P-little/tree/master/%E9%83%A8%E4%BB%B6%E8%A1%A5%E4%B8%81%E5%8C%85/11-1-%E7%9D%A1%E4%BA%86%E5%8D%B3%E9%86%92(0D:6D)%E8%A1%A5%E4%B8%81">clover hotpatch</a>补丁包，打开plist文件。那我们拿出一组数据来讲解怎么把它翻译成oc版本：</p>
<pre><code class="xml">Comment      String       XHC:_PRW to XPRW
Disabled     Boolean      True//此补丁并未生效，这里要改成false才会生效
Find         5F505257         //hex转text的含义即是：_PRW Replace      58505257         //hex转text的含义即是：XPRW TgtBridge    5848435F         //hex转text的含义即是：XHC_</code></pre>
<p>这组改名是对 <code>XHC</code> 下的 PRW 改名为<code> xprw</code>，这样的话，之前 prw 下的 <code>(0x6D, 0x04)</code> 即不生效了。而指定 xhc 的方法即是使用了 tgtbridge，因为整张 dsdt 上有几十上百个 <code>_PRW</code>，你必须通过 tgtbridge 来指定到底是哪一个部件的 <code>_PRW</code>。</p>
<p>那么 OC 到底怎么使用 tgtbridge 来特定某一部件下的内容重命名呢？我们先把上面一段 clover 的补丁转换成 oc 的版本先吧：</p>
<pre><code class="xml">Comment           String        XHC:_PRW to XPRW
Count             Number                      //需要重点解释
Enabled           Boolean       True          //表示应用此补丁，不应用选False
Find              Data          5F505257      //hex转text的含义即是：_PRW
Limit             Number        0             //这个按默认即可 不去管他
Mask              Data          &lt;&gt;            //这个按默认即可 不去管他
OemTableId        Data          &lt;&gt;            //这个按默认即可 不去管他
Replace           Data          58505257      //hex转text的含义即是：XPRW
ReplaceMask       Data          &lt;&gt;            //这个按默认即可 不去管他
Skip              Number                      //需要重点解释
TableLength       Number        0             //这个按默认即可 不去管他
TableSignature    Data          44534454      //hex转text的含义即是：DSDT，这里按默认即可，代表对dsdt进行修改</code></pre>
<p>这里就是一个还没全部翻译好的 oc 版改名 xhc 的 prw。那么如何定位 xhc 下的 <code>_prw</code> 呢，主要是填写 <code>Count</code> 和 <code>Skip</code>。其实 oc 的 <code>tgtbridge</code> 是通过一个个数过去来定位具体哪一个位置的。比如xhc的prw是整张dsdt里面的第55个，那 <code>skip</code> 填 <code>54</code>，意味着跳过前 <code>54</code> 个，从第 <code>55</code> 个开始执行。那执行多少次呢？执行一次 <code>count</code> 就填 1；比如你要同时改第 <code>55</code> 个和 <code>56</code> 个，那 count 就填 <code>2</code>。说了这么多，我来实操一下吧：</p>
<p>打开dsdt，在左下角直接搜索_PRW，就能把整张表的_PRW筛选出来了：<br><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://i.loli.net/2020/10/31/EfxazsJNZLKmgv3.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="截屏2019-11-08上午2.57.43.png"></p>

<p>我总共数了一下，一共有56个_PRW。我们再在主内容栏上按 <kbd> ⌘ </kbd>+<kbd>F</kbd> 搜索 xhc，直接找到 xhc 的 <code>_PRW</code>，刚好我们看到我的 xhc 实在整张表的倒数第 4 个，也就是正数第 53 个：</p>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://i.loli.net/2020/10/31/SzvArXcH4OimtR9.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="截屏2019-11-08上午3.00.36.png"></p>

<p>那么我们就可以补充完整张表了：</p>
<pre><code class="xml">Comment          String       XHC:_PRW to XPRW
Count            Number       1
Enabled          Boolean      True
Find             Data         5F505257
Limit            Number       0
Mask             Data         &lt;&gt;
OemTableId       Data         &lt;&gt;
Replace          Data         58505257
ReplaceMask      Data         &lt;&gt;
Skip             Number       52
TableLength      Number       0
TableSignature   Data         44534454</code></pre>
<p>如果你想第 53、54、55 个都改掉，那 count 就写 3，意味着顺序执行3次。好了，就这样，有问题留言。</p>
<hr>
<h4 id="3-7-1-3-方法三：配合SSDT-重命名的强制睡眠补丁（推荐）"><a href="#3-7-1-3-方法三：配合SSDT-重命名的强制睡眠补丁（推荐）" class="headerlink" title="3.7.1.3 方法三：配合SSDT+重命名的强制睡眠补丁（推荐）"></a>3.7.1.3 方法三：配合SSDT+重命名的强制睡眠补丁（推荐）</h4><p>oc 不提倡用户直接全局重命名，如果真的要用重命名，也一定是搭配 ssdt 去做重命名，所以这个方法也是宪武大大和我最推荐的一种方法。</p>
<p>打开宪武大大的 OC-SSDT 包，找到  <code>0D/6D</code> 文件夹，打开 <code>SSDT-GPRW.dsl</code>。</p>
<pre><code class="asl">// In config ACPI, GPRW to XPRW
// Find: 47505257 02
// Replace: 58505257 02 //这里提示你要应用这个补丁，你必须在config中的ACPI-PATCH里面加入如上重命名内容
//
DefinitionBlock (&quot;&quot;, &quot;SSDT&quot;, 2, &quot;ACDT&quot;, &quot;GPRW&quot;, 0)
&#123;
  External(XPRW, MethodObj) //寻找dsdt表中叫做XPRW的内容，这是要你在config中先把gprw改名成xprw才会生效，这就是为什么这个补丁的重命名必须是这个ssdt和重命名一起用的原因，你第一个重命名不生效，这个ssdt也不会生效。
  Method (GPRW, 2, NotSerialized)
  &#123;
    If (_OSI (&quot;Darwin&quot;)) //为了不破坏dsdt完整性，这里做了系统判断，当你运行windows的时候，此ssdt不生效
     &#123;
       If ((0x6D == Arg0)) //如果你的dsdt中是6D进行判断
       &#123;
         Return (Package ()
         &#123; 0x6D,
           Zero
          &#125;)
       &#125;

       If ((0x0D == Arg0)) //如果你的dsdt中是0D进行判断
       &#123;
         Return (Package ()
         &#123; 0x0D,
           Zero
          &#125;)
        &#125;
      &#125;
  Return (XPRW (Arg0, Arg1)) //当运行mac系统时，如果你的dsdt中XPRW为6d，或者0d时返回为0，即屏蔽。
  &#125;
&#125;</code></pre>
<p>这个 ssdt 不需要你改任何内容，打开后左上角另存为（save as), 其中文件格式(file format)必须选择 <code>ACPI Machine Language Binary</code>，文件名字就叫，记住后缀为 aml。记得将 <code>ssdt-gprw.aml</code> 放入 <code>EFI/OC/ACPI</code> 目录下，并在 <code>config.plist</code> 中加载此 aml 文件。</p>
<p>同时，我们需要在 <code>ACPI--Patch</code> 下增加一条全局重命名来配合此 SSDT。</p>
<pre><code class="xml">Comment: GPRW to XPRW
Count:0
Enabled:YES
Find:&lt;4750525702&gt;
Limit:0
Mask:&lt;&gt;
OemTable:&lt;&gt;
Replace:&lt;5850525702&gt;
ReplaceMask:&lt;&gt;
Skip:0
TableLength:0
TableSignature:&lt;&gt;</code></pre>
<hr>
<h3 id="3-8-OC官方内核补丁集介绍"><a href="#3-8-OC官方内核补丁集介绍" class="headerlink" title="3.8 OC官方内核补丁集介绍"></a>3.8 OC官方内核补丁集介绍</h3><p>这里会长期更新OC官方提供的Kernel Patch。</p>
<hr>
<h4 id="3-8-1-华硕等机型开机卡F1"><a href="#3-8-1-华硕等机型开机卡F1" class="headerlink" title="3.8.1 华硕等机型开机卡F1"></a>3.8.1 华硕等机型开机卡F1</h4><p>注意此kp补丁只对10.14.4以上系统版本生效，旧的我懒得提供了，需要留言。更好的解决卡f1的方案请参照<a href="https://blog.xjn819.com/post/rtc-issues-related-to-oc.html">rtc综述</a></p>
<pre><code class="xml">Kernel
  Patch
     Item 0
     Base         String
     Comment      String    f1 patch （随便填，好记就行）
     Count        Number    1
     Enabled      Boolean   Yes
     Find         Data      75330fb7
     Identifier   String    com.apple.driver.AppleRTC
     Limit        Number    0
     Mask         Data      
     MaxKernel    String
     MinKernel    String
     Replace      Data      eb330fb7
     ReplaceMask  Data
     Skip         Number    0</code></pre>
<hr>
<h4 id="3-8-2-关机卡RTC"><a href="#3-8-2-关机卡RTC" class="headerlink" title="3.8.2 关机卡RTC"></a>3.8.2 关机卡RTC</h4><pre><code class="xml">Kernel
    Patch
      Item 2
       Base         String      __ZN8AppleRTC14updateChecksumEv
       Comment      String      Disable RTC ck poweroff（随便填，好记就行）
       Count        Number      1
       Enabled      Boolean     Yes
       Find         Data
       Identifier   String      com.apple.driver.AppleRTC
       Limit        Number      0
       Mask         Data
       MaxKernel    String
       MinKernel    String
       Replace      Data        c3
       ReplaceMask  Data
       Skip         Number      0</code></pre>
<hr>
<h3 id="3-9-300系列主板开启原生NVRAM"><a href="#3-9-300系列主板开启原生NVRAM" class="headerlink" title="3.9 300系列主板开启原生NVRAM"></a>3.9 300系列主板开启原生NVRAM</h3><p>打开你的DSDT，搜索 <code>001F0000</code>，确定自己的</p>
<ul>
<li>lpc部件名字，如图示，我的lpc部件名叫做<code>LPC0</code>, 别的主板可能叫做<code>LPCB</code>，请根据实际情况记录</li>
<li>lpc的路径，如图左下角红线提示，我的LPC路径在<code>_SB_.PC00.LPC0</code></li>
</ul>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://i.loli.net/2020/11/01/fO69YhztbwBrMsd.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="Screenshot-2020-02-05-at-10.47.54-AM.png"></p>

<ul>
<li>下载<a href="/tools/SSDT-EC-USBX.dsl.zip">SSDT-PMC.dsl</a>，根据自己的dsdt编辑相关内容：</li>
</ul>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://i.loli.net/2020/11/01/gCaplW4bBY39KJs.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="Screenshot-2020-02-05-at-10.53.33-AM.png"></p>

<p>左上角另存为（save as), 其中文件格式(file format)必须选择 <code>ACPI Machine Language Binary</code>，文件名字随便写吧，我就叫 <code>ssdt-pmc.aml</code>，记住后缀为aml。记得将 <code>ssdt-pmc.aml</code> 放入 <code>EFI/OC/ACPI</code> 目录下，并在 <code>config.plist</code> 中添加加载此aml文件。</p>
<ul>
<li>如果你之前模拟过nvram，请执行以下命令删除相关模拟内容：</li>
</ul>
<pre><code class="bash"># 删除文件 LogoutHook.command
sudo rm -rf $(sudo defaults read com.apple.loginwindow LogoutHook)
# 清空 LogoutHook 的触发设置
sudo defaults delete com.apple.loginwindow LogoutHook</code></pre>
<ul>
<li><p>删除EFI下的nvram.plist。</p>
</li>
<li><p>同时你需要对config.plist进行设置：</p>
<ul>
<li>NVRAM–LegacyEnable 选择No</li>
<li>NVRAM–LegacyOverwrite 选择No</li>
<li>Booter–Quirks—-DisableVariableWrite 选择no</li>
<li>你也许要打开NVRAM—WriteFlash 选择YES（请尽可能不要选！）</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-10-Acidanthera-Debug-错误调试"><a href="#3-10-Acidanthera-Debug-错误调试" class="headerlink" title="3.10 Acidanthera Debug 错误调试"></a>3.10 Acidanthera Debug 错误调试</h3><p>此博客有很多疏漏，你可能会碰到很多奇怪的问题而无法解决。一般来说，一张开机-v的截图只能解决一些很简单的问题，一些帮助者可能通过经验判断你的错误所在，但这样的图无法定位错误，而Acidanthera提供了非常非常强大的排错功能，我们可以利用它收集错误报告，在网络上获得帮助。</p>
<p>如果我们需要debug报告，我们需要将所有的Acidanthera的kext以及OC bootloader替换成debug版本，所有的debug版本都会在github中提供。我们下载debug版本的Opencore，替换：</p>
<ul>
<li>EFI/BOOT/<ul>
<li>BOOTx64.efi</li>
</ul>
</li>
<li>EFI/OC/Bootstrap/<ul>
<li> Bootstrap.efi</li>
</ul>
</li>
<li>EFI/OC/Drivers/<ul>
<li>OpenRuntime.efi</li>
</ul>
</li>
<li>EFI/OC/<ul>
<li>OpenCore.efi</li>
</ul>
</li>
<li>下载所有Acidanthera的debug版本kexts，并替换到EFI/OC/kexts</li>
</ul>
<p>修改config.plist中的如下内容：</p>
<ul>
<li><strong>AppleDebug</strong> <code>YES</code></li>
<li><strong>ApplePanic</strong> <code>YES</code></li>
<li><strong>DisableWatchdog</strong> <code>YES</code></li>
<li><strong>Target</strong> <code>67</code></li>
<li><strong>DisplayLevel</strong> <code>2147483714</code></li>
<li><strong>PickerMode</strong> <code>Builtin</code></li>
</ul>
<p>在Config.plist/NVRAM/7C436110-AB2A-4BBB-A880-FE41995C9F82/boot-args栏目中增加</p>
<ul>
<li><code>-liludbgall liludump=30</code></li>
</ul>
<p>保存后重启，你会得到：</p>
<ul>
<li>/EFI/下找到开机启动日志 (e.g. opencore-2020-11-16-083514.txt)</li>
<li>/var/log下得到所有Acidanthera的kext的日志(e.g.Lilu_1.5.0_20.1.txt)</li>
</ul>
<p>如果无法进入系统，则只需要第一份日志。</p>
<p>你可以通过这两份日志快速定位错误，或者在网路上寻求帮助。</p>
<hr>
<h2 id="4-0-OpenCore-进阶"><a href="#4-0-OpenCore-进阶" class="headerlink" title="4.0 OpenCore 进阶"></a>4.0 OpenCore 进阶</h2><p>以下内容对你正常使用黑苹果已经无关了，如果你追求更好的黑果表现，可以看下去，但这部分内容也需要你自己有更好的能力与耐心。如果你不具备足够的条件，我不建议你看下去；如果你的失误导致硬件的损坏，我也不会、也没能力负责。</p>
<hr>
<h3 id="4-1-CPU的变频优化"><a href="#4-1-CPU的变频优化" class="headerlink" title="4.1 CPU的变频优化"></a>4.1 CPU的变频优化</h3><p>此章节对你的要求会相对高一点，并且请你具备如下条件：</p>
<ul>
<li>有耐心</li>
<li>CFG已经解锁（这也许不是必要条件）</li>
<li>已经打开原生电源管理。</li>
<li>此章节只适用于4代之后的CPU。</li>
<li>在调整CPU变频时，出现失误导致CPU温度过高，能有正确的处理能力保证CPU不烧毁，我对极端的后果不负责任。</li>
<li>此教程对无核显用户不友好，需要自己更多的领悟。</li>
<li>如果你不同意第五条，请不要看下去。</li>
</ul>
<p>在Intel四代之后，苹果引入了新的内核级电源管理方式：<code>XCPM</code>（XNU CPU Power Management），这种新的管理方式可以高效地管理电源及变频。同时，苹果也推出了<code>HWP</code> (HardWare controlled Performance states)，这种技术可以快速根据特定程序的需求，作出变频转换。我们这个章节，本质上就是在加载<code>XCPM</code>的情况下，调整<code>HWP</code>来优化CPU的变频。</p>
<p>同时我要说的是，我在论坛上看到很多所谓的“变频”，有的甚至加载了50多个档位的变频，其实这种是完全没有意义的。我认为，变频是能在你需要的高频的时候快速进入高频状态，在关闭程序后又能很快回到低档位，换句话说，其实只需要三个档位就高了：睿频档，正常频率，以及低频档。</p>
<ul>
<li><p>你需要搞清楚自己的cpu型号，并找到、换成与自己cpu型号最接近或者一样的白苹果型号，并且此型号必须带有<code>HWP</code>。一般新的笔记本机型都具有，台式机的话推荐iMac19.1以及Macmini8.1。可查询<a target="_blank" rel="noopener" href="https://blog.daliansky.net/A-command-to-teach-you-how-to-confirm-their-own-models-and-how-to-open-the-HWP.html">此帖</a>选取适合的机型。</p>
</li>
<li><p>执行如下命令：</p>
</li>
</ul>
<pre><code class="bash">cd ~/desktop
mkdir cpu
cd cpu
git clone https://github.com/corpnewt/CPUFriendFriend.git
git clone https://github.com/acidanthera/CPUFriend.git cp ~/desktop/cpu/CPUFriend/tools/ResourceConverter.sh ~/desktop/cpu/
CpuFriendFriend/CPUFriendFriend.command</code></pre>
<ul>
<li><p>你会看到如图的命令行，这里1 of 4代表第一段睿频的设置，以此类推，数值越大睿频越高，下面要求你填写的是最低的频率值，你想要低一点的800MHZ就填08，高一点的1300MHZ就填0D（注意大小写）<img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://i.loli.net/2020/11/01/cRhHzeEiAQXLSds.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="Screen-Shot-2019-12-09-at-11.28.30-AM.png"></p>

</li>
<li><p>填完前两段后，它会要求你填写EPP值，EPP值越低，性能表现越强。我们是填的前两段的低频率部分，我们可以选择节能型的，比如0x80，如果你想极致性能，可以填0x00。<br><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://i.loli.net/2020/11/01/6p4iKMAeIHPyfBC.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="Screen-Shot-2019-12-09-at-11.32.38-AM.png"></p>

</li>
<li><p>直至你填完所有4段变频需求后，便会生成你的变频plist。我们执行以下命令:</p>
</li>
</ul>
<pre><code class="bash">cp ~/Desktop/cpu/CpuFriendFriend/Results/*.* ~/Desktop/cpu</code></pre>
<ul>
<li>我们会在桌面的CPU文件夹中找到你所需要的<code>ResourceConverter.sh</code>以及Mac-xxxxxxx.plist两个文件</li>
<li>执行以下命令生成你最终需要的<code>CPUFriendDataProvider.kext</code>,注意命令行中<code>Mac-AA95B1DDAB278B95.plist</code>，请替换成你自己的文件名，这样我们就可以在桌面的CPU文件夹下拿到<code>CPUFriendDataProvider.kext</code>。</li>
</ul>
<pre><code class="bash">cd ~/Desktop/cpu
./ResourceConverter.sh --kext ~/Desktop/cpu/Mac-AA95B1DDAB278B95.plist</code></pre>
<ul>
<li><p>我们再到CPUFriend的<a target="_blank" rel="noopener" href="https://github.com/acidanthera/CPUFriend/releases">release</a>页面下，下载最新的release版本，得到里面的CPUFriend.kext</p>
</li>
<li><p>将<code>CPUFriendDataProvider.kext</code>与<code>CPUFriend.kext</code>一起放到oc/kexts下,并在config中加载，注意：<code>CPUFriend.kext</code>应该放在<code>CPUFriendDataProvider.kext</code>的前面。</p>
</li>
<li><p>感谢 @请叫我官人 的帮助。完成，自行测试。</p>
</li>
</ul>
<hr>
<h3 id="4-2-5700-XT-Redeon-VII显卡的性能优化"><a href="#4-2-5700-XT-Redeon-VII显卡的性能优化" class="headerlink" title="4.2 5700/XT/Redeon VII显卡的性能优化"></a>4.2 5700/XT/Redeon VII显卡的性能优化</h3><p>此教程已经发于pcbeta:<a target="_blank" rel="noopener" href="http://bbs.pcbeta.com/viewthread-1836920-1-1.html">点此直达</a></p>

	</div>

	

	

	
		<div class="post-tags">
			<i class="fa fa-tags" aria-hidden="true"></i>
			<a class="tag badge badge-secondary post-meta-detail-tag -none-link" href="/tags/Hackintosh/" rel="tag">Hackintosh</a><a class="tag badge badge-secondary post-meta-detail-tag -none-link" href="/tags/OpenCore/" rel="tag">OpenCore</a>
		</div>
	
</article>

	<div id="share_container">
	<div id="share" data-initialized="true">
		<a class="no-pjax icon-wechat" tooltip="分享到微信">
			<button class="btn btn-icon btn-success">
				<span class="btn-inner--icon"><i class="fa fa-weixin"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-douban" tooltip="分享到豆瓣">
			<button class="btn btn-icon btn-primary" style="background: #209261;border: none;">
				豆
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-qq" tooltip="分享到 QQ">
			<button class="btn btn-icon btn-primary" style="background: #2196f3;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-qq"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-qzone" tooltip="分享到 QQ 空间">
			<button class="btn btn-icon btn-primary" style="background: #ffc107;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-star"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-weibo" tooltip="分享到微博">
			<button class="btn btn-icon btn-warning">
				<span class="btn-inner--icon"><i class="fa fa-weibo"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-facebook" tooltip="分享到 Facebook">
			<button class="btn btn-icon btn-primary" style="background: #283593;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-facebook"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-twitter" tooltip="分享到 Twitter">
			<button class="btn btn-icon btn-primary" style="background: #03a9f4;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-twitter"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-telegram" href="https://telegram.me/share/url?url=https://blog.xjn819.com/post/opencore-guide.html&text=使用 OpenCore 引导黑苹果" tooltip="分享到 Telegram">
			<button class="btn btn-icon btn-primary" style="background: #42a5f5;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-telegram"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-copy-link" id="share_copy_link" tooltip="复制链接">
			<button class="btn btn-icon btn-default">
				<span class="btn-inner--icon"><i class="fa fa-link"></i></span>
			</button>
		</a>
	</div>
	<button id="share_show" class="btn btn-icon btn-primary" tooltip="分享">
		<span class="btn-inner--icon"><i class="fa fa-share"></i></span>
	</button>
</div>
<script type="text/javascript">
	socialShare("#share", {
	    title : '使用 OpenCore 引导黑苹果',
	    description : '简介OpenCore(OC) 是一种新的引导方式，越来越多的 kexts 开始放弃 Clover, ...',
	    wechatQrcodeTitle : "分享到微信",
	    wechatQrcodeHelper : '微信扫描二维码',
	    source : 'https://blog.xjn819.com/post/opencore-guide.html'
	});
	$("#share_show")[0].onclick = function(){
		$("#share_container").addClass("opened");
	};
	$("#share_copy_link")[0].onclick = function(){
		let input = document.createElement('input');
		document.body.appendChild(input);
		input.setAttribute("value", window.location.href);
		input.setAttribute("readonly", "readonly");
		input.setAttribute("style", "opacity: 0;mouse-events:none;");
		input.select();
		if (document.execCommand('copy')){
			iziToast.show({
				title: '链接已复制',
				message: "链接已复制到剪贴板",
				class: 'shadow',
				position: 'topRight',
				backgroundColor: '#2dce89',
				titleColor: '#ffffff',
				messageColor: '#ffffff',
				iconColor: '#ffffff',
				progressBarColor: '#ffffff',
				icon: 'fa fa-check',
				timeout: 5000
			});
		}else{
			iziToast.show({
				title: '复制失败',
				message: "请手动复制链接",
				class: 'shadow',
				position: 'topRight',
				backgroundColor: '#f5365c',
				titleColor: '#ffffff',
				messageColor: '#ffffff',
				iconColor: '#ffffff',
				progressBarColor: '#ffffff',
				icon: 'fa fa-close',
				timeout: 5000
			});
		}
		document.body.removeChild(input);
	};
</script>


<div id="post_comment" class="card shadow-sm">
	<div id="gitalk-container"></div>
<script type="text/javascript">
	var gitalk = new Gitalk({
		clientID: '86a6322e810d06834891',
		clientSecret: 'eaf77d01ffaddf2f06a2a4bbac944d8cca3d0c91',
		repo: 'OCNHTeam.github.io',
		owner: 'OCNHTeam',
		admin: ['SeonMe'],
		id: location.pathname,
		distractionFreeMode: false
	})
	gitalk.render('gitalk-container');
</script>

</div>


<div class="post-navigation card shadow-sm"><div class="post-navigation-item post-navigation-pre"><span class="page-navigation-extra-text"><i class="fa fa-arrow-circle-o-left" aria-hidden="true"></i>上一篇</span><a href="/post/kernel-panic-report-analysis.html" rel="prev"> 内核崩溃报告解读</a></div><div class="post-navigation-item post-navigation-next"><span class="page-navigation-extra-text">下一篇 <i class="fa fa-arrow-circle-o-right" aria-hidden="true"></i></span><a href="/post/rtc-issues-related-to-oc.html" rel="next"> RTC综述</a></div></div>



		
		
		
		

					<footer id="footer" class="site-footer card shadow-sm border-0">
						
						<div>Theme <a target="_blank" rel="noopener" href="https://github.com/solstice23/hexo-theme-argon"><strong>Argon</strong></a> | Powered by Hexo</div>
						<span id="busuanzi_container_site_uv">
							本站访客数 <span id="busuanzi_value_site_uv"></span> 人次
						</span>
					</footer>
				</main>
			</div>
		</div>
		
<script src="/argontheme.js"></script>

		
		
		

		
			<script>
				var argonEnableCodeHighlight = true;
			</script>
			
<link rel="stylesheet" href="/assets/vendor/highlight/styles/vs2015.css">

		

	</div>
</div>
<noscript>
	<style>
		article img.lazyload[src^="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPg"]{display: none;}
		.comment-item-text .comment-sticker.lazyload{display: none;}
	</style>
</noscript>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0SS4LFYBFR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0SS4LFYBFR');
</script>
</body>



</html>

